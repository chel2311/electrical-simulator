<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>電気回路シミュレーター - 初級研修</title>
  <style>
    :root {
      --corporate-color: #005BAB;
      --accent-color: #FF961C;
      --secondary-color: #4D8BC9;
      --light-blue: #E0EEF9;
      --background-color: #f5f5f5;
      --text-color: #333;
      --light-gray: #E0E0E0;
      --mid-gray: #9E9E9E;
      --dark-gray: #616161;
      --header-height: min(60px, 8vh);
      --footer-height: min(40px, 6vh);
      --success-color: #28a745;
      --warning-color: #ffc107;
      --danger-color: #dc3545;
      --info-color: #17a2b8;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: "メイリオ", Meiryo, sans-serif;
    }
    
    body {
      background-color: var(--background-color);
      color: var(--text-color);
      line-height: 1.6;
    }
    
    .header {
      background-color: var(--corporate-color);
      color: white;
      height: var(--header-height);
      display: flex;
      align-items: center;
      padding: 0 20px;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 100;
      justify-content: space-between;
    }
    
    .header h1 {
      font-size: clamp(16px, 2.5vw, 20px);
      text-align: left;
    }
    
    .main-nav {
      background-color: var(--light-blue);
      position: fixed;
      top: var(--header-height);
      left: 0;
      right: 0;
      z-index: 99;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    
    .nav-list {
      display: flex;
      list-style: none;
      margin: 0;
      padding: 0;
      overflow-x: auto;
    }
    
    .nav-item {
      padding: 10px 15px;
      white-space: nowrap;
      font-size: 14px;
      color: var(--corporate-color);
      cursor: pointer;
      transition: background-color 0.3s;
      border-bottom: 3px solid transparent;
    }
    
    .nav-item:hover {
      background-color: rgba(0, 91, 171, 0.1);
    }
    
    .nav-item.active {
      border-bottom: 3px solid var(--corporate-color);
      font-weight: bold;
    }
    
    .footer {
      background-color: var(--corporate-color);
      color: white;
      height: var(--footer-height);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 20px;
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
    }
    
    .page-number {
      margin-left: auto;
    }
    
    .container {
      padding-top: calc(var(--header-height) + clamp(30px, 5vh, 45px));
      padding-bottom: calc(var(--footer-height) + clamp(15px, 3vh, 20px));
      width: 100%;
      max-width: min(1200px, 95vw);
      margin: 0 auto;
      padding-left: clamp(10px, 2vw, 20px);
      padding-right: clamp(10px, 2vw, 20px);
    }
    
    .circuit-container {
      display: flex;
      flex-direction: column;
      gap: 20px;
      margin-bottom: 20px;
    }
    
    .circuit {
      background-color: white;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }
    
    .circuit-title {
      color: var(--corporate-color);
      margin-bottom: 10px;
      border-bottom: 2px solid var(--corporate-color);
      padding-bottom: 5px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .circuit-title h2 {
      font-size: 18px;
    }
    
    .circuit-status {
      font-size: 14px;
      padding: 4px 8px;
      border-radius: 4px;
      background-color: var(--light-gray);
    }
    
    .circuit-status.on {
      background-color: var(--accent-color);
      color: white;
    }
    
    .circuit-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: relative;
      min-height: 220px;
      height: clamp(220px, 30vh, 300px);
    }
    
    .circuit-content.larger {
      min-height: 350px;
      height: clamp(350px, 45vh, 450px);
    }
    
    .circuit-svg {
      width: 100%;
      height: 100%;
    }
    
    .circuit-description {
      margin-top: 10px;
      font-size: 14px;
      background-color: #f0f0f0;
      border-radius: 4px;
      padding: 10px;
    }
    
    .switch {
      cursor: pointer;
    }
    
    .legend {
      margin-top: 30px;
      background-color: white;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }
    
    .legend h2 {
      color: var(--corporate-color);
      font-size: 18px;
      margin-bottom: 10px;
      border-bottom: 2px solid var(--corporate-color);
      padding-bottom: 5px;
    }
    
    .legend-items {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
    }
    
    .legend-item {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .legend-color {
      width: 24px;
      height: 3px;
      border-radius: 3px;
    }
    
    .legend-text {
      font-size: 14px;
    }
    
    .label {
      font-size: 12px;
    }
    
    .w-color {
      background-color: #AAAAAA;
    }
    
    .b-color {
      background-color: #333;
    }
    
    .r-color {
      background-color: #FF0000;
    }
    
    .current-path {
      stroke-dasharray: 5;
      animation: flow 0.5s linear infinite;
    }
    
    @keyframes flow {
      to {
        stroke-dashoffset: -10;
      }
    }
    
    .interactive-element {
      cursor: pointer;
      transition: transform 0.3s ease;
    }
    
    .button {
      background-color: var(--corporate-color);
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      margin-top: 10px;
      transition: background-color 0.3s, transform 0.2s;
    }
    
    .button:hover {
      background-color: #0078e7;
      transform: translateY(-2px);
    }
    
    .button:active {
      transform: translateY(0);
    }
    
    .tabs {
      display: flex;
      margin-bottom: 20px;
      border-bottom: 2px solid var(--corporate-color);
    }
    
    .tab {
      padding: 10px 20px;
      cursor: pointer;
      background-color: white;
      border: 1px solid #ddd;
      border-bottom: none;
      border-radius: 5px 5px 0 0;
      margin-right: 5px;
      transition: all 0.3s ease;
    }
    
    .tab:hover {
      background-color: var(--light-blue);
    }
    
    .tab.active {
      background-color: var(--corporate-color);
      color: white;
      border-color: var(--corporate-color);
    }
    
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
    }
    
    /* 新しく追加したスタイル */
    .help-tip {
      background-color: var(--accent-color);
      border-radius: 50%;
      width: 20px;
      height: 20px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      cursor: pointer;
      margin-left: 5px;
      font-size: 12px;
    }
    
    .tooltip {
      position: absolute;
      background-color: white;
      border: 1px solid var(--light-gray);
      padding: 10px;
      border-radius: 5px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
      z-index: 10;
      max-width: 300px;
      display: none;
    }
    
    .panel {
      background-color: white;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 20px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }
    
    .panel-title {
      font-size: 16px;
      color: var(--corporate-color);
      margin-bottom: 10px;
      font-weight: bold;
    }
    
    .measurement-display {
      background-color: #f9f9f9;
      border: 1px solid var(--light-gray);
      border-radius: 5px;
      padding: 10px;
      margin-top: 10px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    
    .meter {
      padding: 5px 10px;
      background-color: white;
      border: 1px solid #ddd;
      border-radius: 4px;
      display: flex;
      align-items: center;
      gap: 5px;
    }
    
    .meter-label {
      font-size: 12px;
      color: var(--dark-gray);
    }
    
    .meter-value {
      font-weight: bold;
      color: var(--text-color);
    }
    
    .troubleshooting-panel {
      background-color: #f9f9f9;
      border: 1px solid var(--light-gray);
      border-radius: 5px;
      padding: 15px;
      margin-top: 15px;
    }
    
    .problem-desc {
      margin-bottom: 10px;
      font-weight: bold;
    }
    
    .hint-btn {
      background-color: var(--secondary-color);
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 12px;
      margin-right: 10px;
    }
    
    .solution-btn {
      background-color: var(--accent-color);
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 12px;
    }
    
    .checklist {
      list-style-type: none;
      margin: 15px 0;
    }
    
    .checklist li {
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .checklist input[type="checkbox"] {
      width: 16px;
      height: 16px;
    }
    
    .safety-notice {
      background-color: #ffe9e9;
      border-left: 4px solid var(--danger-color);
      padding: 10px 15px;
      margin: 15px 0;
      border-radius: 0 4px 4px 0;
    }
    
    .safety-title {
      color: var(--danger-color);
      font-weight: bold;
      margin-bottom: 5px;
      display: flex;
      align-items: center;
      gap: 5px;
    }
    
    .safety-icon {
      font-size: 16px;
    }
    
    .quiz-container {
      margin-top: 20px;
    }
    
    .quiz-question {
      margin-bottom: 15px;
      font-weight: bold;
    }
    
    .quiz-options {
      list-style-type: none;
      margin-bottom: 20px;
    }
    
    .quiz-options li {
      margin-bottom: 8px;
    }
    
    .quiz-option label {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      padding: 5px;
      border-radius: 4px;
      transition: background-color 0.2s;
    }
    
    .quiz-option label:hover {
      background-color: var(--light-blue);
    }
    
    .check-answer-btn {
      background-color: var(--corporate-color);
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 4px;
      cursor: pointer;
    }
    
    .section-container {
      display: none;
    }
    
    .section-container.active {
      display: block;
    }
    
        /* 追加: シンボルテーブルのスタイル改善 */
    .symbol-table {
      width: 100%;
      border-collapse: collapse;
      margin: 15px 0 30px 0;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    
    .symbol-table th {
      background-color: var(--light-blue);
      color: var(--corporate-color);
      font-weight: bold;
      text-align: left;
      padding: 12px 15px;
      border-bottom: 2px solid var(--corporate-color);
    }
    
    .symbol-table td {
      padding: 12px 15px;
      vertical-align: middle;
      border-bottom: 1px solid var(--light-gray);
    }
    
    .symbol-table tr:hover {
      background-color: rgba(0, 91, 171, 0.05);
    }
    
    .symbol-table td:first-child {
      width: 120px;
      text-align: center;
    }
    
    .symbol-table td:nth-child(2) {
      width: 30%;
      font-weight: bold;
      color: var(--corporate-color);
    }
    
    .symbol-table td:last-child {
      color: var(--text-color);
    }
    
    .symbol-img {
      width: 80px;
      height: 80px;
      object-fit: contain;
    }
    
    
    /* レスポンシブデザイン */
    @media (max-width: 992px) {
      .container {
        max-width: 100%;
      }
    }
    
    @media (max-width: 768px) {
      .legend-items {
        grid-template-columns: repeat(2, 1fr);
      }
      
      .measurement-display {
        flex-direction: column;
      }
    }
    
    @media (max-width: 480px) {
      .legend-items {
        grid-template-columns: 1fr;
      }
      
      .circuit-content {
        min-height: 180px;
        height: clamp(180px, 25vh, 220px);
      }
      
      .circuit-content.larger {
        min-height: 300px;
        height: clamp(300px, 40vh, 350px);
      }
    }
  </style>
</head>
<body>
  <header class="header">
    <h1>電気回路シミュレーター</h1>
  </header>
  
  <nav class="main-nav">
    <ul class="nav-list">
      <li class="nav-item active" data-section="basic">基本知識</li>
      <li class="nav-item" data-section="switch">スイッチ回路</li>
      <li class="nav-item" data-section="outlet">コンセント回路</li>
      <li class="nav-item" data-section="trouble">トラブルシューティング</li>
      <li class="nav-item" data-section="safety">安全情報</li>
      <li class="nav-item" data-section="quiz">理解度チェック</li>
    </ul>
  </nav>
  
  <main class="container">
    <!-- 基本知識セクション -->
    <div id="basicSection" class="section-container active">
      <div class="panel">
        <div class="panel-title">電気設備の基本シンボル</div>
        <table class="symbol-table">
          <thead>
            <tr>
              <th>シンボル</th>
              <th>名称</th>
              <th>説明</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>
				<svg width="88.89" height="88.89" viewBox="0 0 66.67 66.67" xmlns="http://www.w3.org/2000/svg">
				  <style>
				    .shape {
				      fill: none;
				      stroke: black;
				      stroke-width: 5;
				      stroke-linecap: round;
				    }
				  </style>

				  <circle cx="33.33" cy="33.33" r="30" class="shape" />

				  <path d="M 21.53,21.53 A 16.67 16.67 0 0 0 21.53,45.13" class="shape" />

				  <path d="M 45.13,45.13 A 16.67 16.67 0 0 0 45.13,21.53" class="shape" />

				</svg>
              </td>
              <td>引っ掛けシーリング</td>
              <td>天井に簡易型で取り付ける照明器具を表します。</td>
            </tr>
            <tr>
              <td>
				<svg width="100" height="100" xmlns="http://www.w3.org/2000/svg">
				  <circle cx="50" cy="50" r="26.67" fill="black" />
				</svg>
              </td>
              <td>片切スイッチ</td>
              <td>電気の流れをON/OFFするための基本的なスイッチを表します。</td>
            </tr>
            <tr>
              <td>
				<svg width="120" height="100" xmlns="http://www.w3.org/2000/svg">
				  <circle cx="50" cy="50" r="26.67" fill="black" />
				  <text x="95" y="70" font-size="50" text-anchor="middle" fill="black">3</text>
				</svg>
              </td>
              <td>3路スイッチ</td>
              <td>2箇所から照明を操作するための切り替えスイッチです。</td>
            </tr>
            <tr>
              <td>
				<svg width="100" height="100" xmlns="http://www.w3.org/2000/svg">
				  <circle cx="50" cy="50" r="40" stroke="black" stroke-width="3" fill="none" />
				  <rect x="33" y="12" width="7" height="75" fill="black" />
				  <rect x="60" y="12" width="7" height="75" fill="black" />
				  <path d="M 10 59 A 40 30 0 0 0 90 59 H 10 Z" fill="black" />
				</svg>
              </td>
              <td>コンセント</td>
              <td>電源を取るためのコンセントを表します。</td>
            </tr>
          </tbody>
        </table>
        
        <div class="panel-title">電気配線の基本</div>
        <p>電気配線には主に次の種類があります：</p>
        <ul>
          <li><strong>白線（W）</strong>：接地側（0V）、中性線とも呼ばれます</li>
          <li><strong>黒線（B）</strong>：非接地側（100V）</li>
          <li><strong>赤線（R）</strong>：スイッチ間を接続するトラベラー線などに使用されます</li>
          <li><strong>緑線</strong>：安全のための接地（アース）線</li>
        </ul>
        
        <div class="safety-notice">
          <div class="safety-title"><span class="safety-icon">⚠️</span> 安全注意事項</div>
          <p>電気工事は有資格者が行うべきです。無資格での電気工事は法律で禁止されており、感電や火災の危険があります。</p>
        </div>
      </div>
      
      <div class="panel">
        <div class="panel-title">電気回路の種類</div>
        <p>住宅用電気設備では、主に以下の回路が使用されています：</p>
        <ul>
          <li><strong>照明回路</strong>：照明器具を制御するための回路</li>
          <li><strong>コンセント回路</strong>：電気製品に電源を供給するための回路</li>
          <li><strong>専用回路</strong>：エアコンや電子レンジなど大電力を消費する機器のための専用回路</li>
          <li><strong>漏電遮断器回路</strong>：感電や火災の危険を防ぐための安全回路</li>
        </ul>
        <p>本シミュレーターでは、照明回路（各種スイッチ回路）とコンセント回路の動作を学ぶことができます。</p>
      </div>
    </div>
    
    <!-- スイッチ回路セクション -->
    <div id="switchSection" class="section-container">
      <div class="circuit-container">
        <section class="circuit" id="single-switch">
          <div class="circuit-title">
            <h2>1. 片切スイッチ回路</h2>
            <div class="circuit-status" id="singleSwitchStatus">OFF</div>
          </div>
          <div class="circuit-content">
            <svg class="circuit-svg" viewBox="0 0 800 200" xmlns="http://www.w3.org/2000/svg">
              <!-- Power source -->
              <text x="30" y="50" class="label">0V[接地]</text>
              <text x="1" y="150" class="label">100V[非接地]</text>
              
              <!-- White wire (neutral) - changed to gray color -->
              <path d="M 100 50 L 400 50 L 400 100" stroke="#AAAAAA" stroke-width="3" fill="none" class="w-wire"/>
              
              <!-- Black wire (hot) -->
              <path d="M 100 150 L 200 150" stroke="#333" stroke-width="3" fill="none" class="b-wire"/>
              <path d="M 300 150 L 400 150 L 400 120" stroke="#333" stroke-width="3" fill="none" class="b-wire" id="singleSwitchPath"/>
              
              <!-- Switch -->
              <g class="switch" id="singleSwitch">
                <rect x="200" y="130" width="100" height="40" fill="white" stroke="#333" stroke-width="2" rx="5"/>
                <line x1="200" y1="150" x2="220" y2="150" stroke="#333" stroke-width="3"/>
                <line x1="280" y1="150" x2="300" y2="150" stroke="#333" stroke-width="3"/>
                <line x1="220" y1="150" x2="280" y2="130" stroke="#333" stroke-width="3" id="singleSwitchLine"/>
                <circle cx="220" cy="150" r="4" fill="#333"/>
                <circle cx="280" cy="150" r="4" fill="#333"/>
                <text x="250" y="120" text-anchor="middle" font-size="12">片切スイッチ</text>
              </g>
              
              <!-- Labels with background for better visibility -->
              <rect x="100" y="25" width="70" height="18" fill="white" opacity="0.8" rx="3"></rect>
              <text x="85" y="40" class="label">白線 (W)</text>
              <rect x="60" y="175" width="70" height="18" fill="white" opacity="0.8" rx="3"></rect>
              <text x="85" y="170" class="label">黒線 (B)</text>
              
              <!-- Current Flow Animation Path (initially hidden) - 黒線から白線への流れに修正 -->
              <path d="M 100 150 L 220 150 L 280 150 L 300 150 L 400 150 L 400 100 L 400 50 L 100 50" 
                    stroke="#FF961C" stroke-width="4" fill="none" opacity="0" id="singleSwitchCurrent" class="current-path"/>
              
              <!-- Lamp with simplified style - moved below current path -->
              <circle cx="400" cy="110" r="20" fill="white" stroke="#333" stroke-width="2" id="singleSwitchLamp"/>
              <text x="400" y="115" text-anchor="middle" font-size="11">照明</text>
            </svg>
          </div>
          <div class="measurement-display">
            <div class="meter">
              <span class="meter-label">電圧:</span>
              <span class="meter-value" id="singleSwitchVoltage">0 V</span>
            </div>
            <div class="meter">
              <span class="meter-label">電流:</span>
              <span class="meter-value" id="singleSwitchCurrent">0.0 A</span>
            </div>
            <div class="meter">
              <span class="meter-label">消費電力:</span>
              <span class="meter-value" id="singleSwitchPower">0 W</span>
            </div>
          </div>
          <div class="circuit-description">
            片切スイッチは1箇所から照明のON/OFFを切り替える基本的な回路です。黒線（B）側にスイッチを設置します。スイッチをクリックすると状態が切り替わります。電流は黒線（100V）から白線（0V）へ流れます。
            <button class="help-tip" data-tip="片切スイッチは最も一般的なスイッチです。廊下や洗面所など１箇所からの操作で十分な場所に使用されます。">?</button>
          </div>
          <div class="troubleshooting-panel" style="display: none;">
            <div class="problem-desc">問題: 照明が点灯しません。考えられる原因を特定してください。</div>
            <button class="hint-btn">ヒントを表示</button>
            <button class="solution-btn">解決策を表示</button>
            <div class="hint" style="display: none; margin-top: 10px; color: #0078e7;">
              ヒント: スイッチの接点が正しく接続されているか、電球が切れていないかを確認しましょう。
            </div>
            <div class="solution" style="display: none; margin-top: 10px; color: #28a745;">
              解決策: 1. スイッチの接点を確認し、必要に応じて交換する 2. 電球が切れていれば交換する 3. 配線の接続を確認する
            </div>
          </div>
        </section>
        
        <section class="circuit" id="three-way-switch">
          <div class="circuit-title">
            <h2>2. 3路スイッチ回路</h2>
            <div class="circuit-status" id="threeWaySwitchStatus">OFF</div>
          </div>
          <div class="circuit-content">
            <svg class="circuit-svg" viewBox="0 0 900 200" xmlns="http://www.w3.org/2000/svg">
              <!-- Power source -->
              <text x="20" y="50" class="label">0V[接地]</text>
              <text x="1" y="150" class="label">100V[非接地]</text>
              
              <!-- White wire (neutral) - changed to gray color -->
              <path d="M 80 50 L 650 50 L 650 100" stroke="#AAAAAA" stroke-width="3" fill="none" class="w-wire"/>
              
              <!-- Black wire (hot) -->
              <path d="M 80 150 L 150 150" stroke="#333" stroke-width="3" fill="none" class="b-wire"/>
              
              <!-- 3-way switch 1 -->
              <g class="switch" id="threeWaySwitch1">
                <rect x="150" y="130" width="70" height="60" fill="white" stroke="#333" stroke-width="2" rx="5"/>
                <line x1="150" y1="150" x2="170" y2="150" stroke="#333" stroke-width="3"/>
                <circle cx="170" cy="150" r="4" fill="#333"/>
                <circle cx="200" cy="140" r="4" fill="#333"/>
                <circle cx="200" cy="160" r="4" fill="#333"/>
                <line x1="170" y1="150" x2="200" y2="140" stroke="#333" stroke-width="3" id="threeWaySwitch1Line"/>
                <text x="185" y="120" text-anchor="middle" font-size="12">3路スイッチ1</text>
              </g>
              
              <!-- Traveler wires -->
              <path d="M 200 140 L 390 140" stroke="#FF0000" stroke-width="3" fill="none" class="r-wire"/>
              <path d="M 200 160 L 390 160" stroke="#FF0000" stroke-width="3" fill="none" class="r-wire"/>
              
              <!-- 3-way switch 2 -->
              <g class="switch" id="threeWaySwitch2">
                <rect x="390" y="130" width="70" height="60" fill="white" stroke="#333" stroke-width="2" rx="5"/>
                <circle cx="390" cy="140" r="4" fill="#333"/>
                <circle cx="390" cy="160" r="4" fill="#333"/>
                <circle cx="440" cy="150" r="4" fill="#333"/>
                <line x1="390" y1="140" x2="440" y2="150" stroke="#333" stroke-width="3" id="threeWaySwitch2Line"/>
                <line x1="440" y1="150" x2="460" y2="150" stroke="#333" stroke-width="3"/>
                <text x="425" y="120" text-anchor="middle" font-size="12">3路スイッチ2</text>
              </g>
              
              <!-- Output to lamp -->
              <path d="M 460 150 L 650 150 L 650 120" stroke="#333" stroke-width="3" fill="none" class="b-wire"/>
              
              <!-- Labels with background for better visibility -->
              <rect x="100" y="25" width="70" height="18" fill="white" opacity="0.8" rx="3"></rect>
              <text x="85" y="40" class="label">白線 (W)</text>
              <rect x="60" y="175" width="70" height="18" fill="white" opacity="0.8" rx="3"></rect>
              <text x="85" y="170" class="label">黒線 (B)</text>
              <rect x="285" y="117" width="70" height="18" fill="white" opacity="0.8" rx="3"></rect>
              <text x="295" y="130" class="label">赤線 (R)</text>
              <rect x="285" y="167" width="70" height="18" fill="white" opacity="0.8" rx="3"></rect>
              <text x="295" y="180" class="label">赤線 (R)</text>
              
              <!-- Current Flow Animation Path (initially hidden) - 黒線から白線への流れに修正 -->
              <path d="" stroke="#FF961C" stroke-width="4" fill="none" opacity="0" id="threeWaySwitchCurrent" class="current-path"/>
              
              <!-- Lamp with simplified style - moved below current path -->
              <circle cx="650" cy="110" r="20" fill="white" stroke="#333" stroke-width="2" id="threeWaySwitchLamp"/>
              <text x="650" y="115" text-anchor="middle" font-size="12">照明</text>
            </svg>
          </div>
          <div class="measurement-display">
            <div class="meter">
              <span class="meter-label">電圧:</span>
              <span class="meter-value" id="threeWaySwitchVoltage">0 V</span>
            </div>
            <div class="meter">
              <span class="meter-label">電流:</span>
              <span class="meter-value" id="threeWaySwitchCurrentValue">0.0 A</span>
            </div>
            <div class="meter">
              <span class="meter-label">消費電力:</span>
              <span class="meter-value" id="threeWaySwitchPower">0 W</span>
            </div>
          </div>
          <div class="circuit-description">
            3路スイッチ回路は2箇所から照明のON/OFFを切り替えることができます。赤線（R）のトラベラー線が特徴的です。どちらか一方のスイッチを切り替えると状態が反転します。電流は黒線（100V）から白線（0V）へ流れます。
            <button class="help-tip" data-tip="3路スイッチは階段の上下や廊下の両端など、2箇所から照明を操作したい場合に使用します。">?</button>
          </div>
        </section>
        
        <section class="circuit" id="four-way-switch">
          <div class="circuit-title">
            <h2>3. 3路+4路スイッチ回路</h2>
            <div class="circuit-status" id="fourWaySwitchStatus">OFF</div>
          </div>
          <div class="circuit-content">
            <svg class="circuit-svg" viewBox="0 0 800 220" xmlns="http://www.w3.org/2000/svg">
              <!-- Power source -->
              <text x="20" y="50" class="label">0V[接地]</text>
              <text x="-5" y="170" class="label">100V[非接地]</text>
              
              <!-- White wire (neutral) - changed from blue to gray -->
              <path d="M 70 50 L 730 50 L 730 100" stroke="#AAAAAA" stroke-width="3" fill="none" class="w-wire"/>
              
              <!-- Black wire (hot) -->
              <path d="M 70 170 L 120 170" stroke="#333" stroke-width="3" fill="none" class="b-wire"/>
              
              <!-- 3-way switch 1 -->
              <g class="switch" id="fourWaySwitch1">
                <rect x="120" y="150" width="60" height="60" fill="white" stroke="#333" stroke-width="2" rx="5"/>
                <line x1="120" y1="170" x2="135" y2="170" stroke="#333" stroke-width="3"/>
                <circle cx="135" cy="170" r="4" fill="#333"/>
                <circle cx="165" cy="160" r="4" fill="#333"/>
                <circle cx="165" cy="180" r="4" fill="#333"/>
                <line x1="135" y1="170" x2="165" y2="160" stroke="#333" stroke-width="3" id="fourWaySwitch1Line"/>
                <text x="150" y="130" text-anchor="middle" font-size="12">3路スイッチ1</text>
              </g>
              
              <!-- Traveler wires to 4-way -->
              <path d="M 165 160 L 250 160" stroke="#FF0000" stroke-width="3" fill="none" class="r-wire"/>
              <path d="M 165 180 L 250 180" stroke="#FF0000" stroke-width="3" fill="none" class="r-wire"/>
              
              <!-- 4-way switch -->
              <g class="switch" id="fourWayMiddleSwitch">
                <rect x="250" y="140" width="100" height="80" fill="white" stroke="#333" stroke-width="2" rx="5"/>
                <circle cx="250" cy="160" r="4" fill="#333"/>
                <circle cx="250" cy="180" r="4" fill="#333"/>
                <circle cx="350" cy="160" r="4" fill="#333"/>
                <circle cx="350" cy="180" r="4" fill="#333"/>
                
                <!-- Default crossed wires -->
                <line x1="250" y1="160" x2="350" y2="180" stroke="#333" stroke-width="3" id="fourWayMiddleSwitch1"/>
                <line x1="250" y1="180" x2="350" y2="160" stroke="#333" stroke-width="3" id="fourWayMiddleSwitch2"/>
                <text x="300" y="130" text-anchor="middle" font-size="12">4路スイッチ</text>
              </g>
              
              <!-- Traveler wires to 3-way -->
              <path d="M 350 160 L 435 160" stroke="#FF0000" stroke-width="3" fill="none" class="r-wire"/>
              <path d="M 350 180 L 435 180" stroke="#FF0000" stroke-width="3" fill="none" class="r-wire"/>
              
              <!-- 3-way switch 2 -->
              <g class="switch" id="fourWaySwitch2">
                <rect x="435" y="150" width="60" height="60" fill="white" stroke="#333" stroke-width="2" rx="5"/>
                <circle cx="435" cy="160" r="4" fill="#333"/>
                <circle cx="435" cy="180" r="4" fill="#333"/>
                <circle cx="475" cy="170" r="4" fill="#333"/>
                <line x1="435" y1="160" x2="475" y2="170" stroke="#333" stroke-width="3" id="fourWaySwitch2Line"/>
                <line x1="475" y1="170" x2="495" y2="170" stroke="#333" stroke-width="3"/>
                <text x="465" y="130" text-anchor="middle" font-size="12">3路スイッチ2</text>
              </g>
              
              <!-- Output to lamp -->
              <path d="M 495 170 L 730 170 L 730 120" stroke="#333" stroke-width="3" fill="none" class="b-wire"/>
              
              <!-- Labels with background for better visibility -->
              <text x="70" y="40" class="label">白線 (W)</text>
              <text x="70" y="190" class="label">黒線 (B)</text>
              <rect x="200" y="137" width="70" height="18" fill="white" opacity="0.8" rx="3"></rect>
              <text x="210" y="150" class="label">赤線 (R)</text>
              <rect x="200" y="187" width="70" height="18" fill="white" opacity="0.8" rx="3"></rect>
              <text x="210" y="200" class="label">赤線 (R)</text>
              <rect x="380" y="137" width="70" height="18" fill="white" opacity="0.8" rx="3"></rect>
              <text x="390" y="150" class="label">赤線 (R)</text>
              <rect x="380" y="187" width="70" height="18" fill="white" opacity="0.8" rx="3"></rect>
              <text x="390" y="200" class="label">赤線 (R)</text>
              
              <!-- Current Flow Animation Path (initially hidden) - 黒線から白線への流れに修正 -->
              <path d="" stroke="#FF961C" stroke-width="4" fill="none" opacity="0" id="fourWaySwitchCurrent" class="current-path"/>
              
              <!-- Lamp - moved below current path -->
              <circle cx="730" cy="110" r="20" fill="#f0f0f0" stroke="#333" stroke-width="2" id="fourWaySwitchLamp"/>
              <text x="730" y="115" text-anchor="middle" font-size="11">照明</text>
            </svg>
          </div>
          <div class="measurement-display">
            <div class="meter">
              <span class="meter-label">電圧:</span>
              <span class="meter-value" id="fourWaySwitchVoltage">0 V</span>
            </div>
            <div class="meter">
              <span class="meter-label">電流:</span>
              <span class="meter-value" id="fourWaySwitchCurrentValue">0.0 A</span>
            </div>
            <div class="meter">
              <span class="meter-label">消費電力:</span>
              <span class="meter-value" id="fourWaySwitchPower">0 W</span>
            </div>
          </div>
          <div class="circuit-description" style="margin-top: 40px; margin-bottom: 20px;">
            3路+4路スイッチ回路は3箇所から照明のON/OFFを切り替えることができます。いずれか1つのスイッチを切り替えるたびに状態が反転します。電流は黒線（100V）から白線（0V）へ流れます。
            <button class="help-tip" data-tip="4路スイッチは3路スイッチと組み合わせて使用し、3か所以上から照明を操作できるようにします。廊下と階段の組み合わせなど、複数箇所での操作が必要な場合に使用します。">?</button>
          </div>
        </section>
        
        <section class="legend">
          <h2>凡例</h2>
          <div class="legend-items">
            <div class="legend-item">
              <div class="legend-color w-color"></div>
              <div class="legend-text">白線 (W) - 接地側 0V</div>
            </div>
            <div class="legend-item">
              <div class="legend-color b-color"></div>
              <div class="legend-text">黒線 (B) - 非接地側 100V</div>
            </div>
            <div class="legend-item">
              <div class="legend-color r-color"></div>
              <div class="legend-text">赤線 (R) - 渡り線（トラベラー）</div>
            </div>
            <div class="legend-item">
              <div class="legend-color" style="background-color: #FF961C;"></div>
              <div class="legend-text">電流の流れ（黒→白）</div>
            </div>
            <div class="legend-item">
              <div style="width: 20px; height: 20px; background-color: #FFD700; border-radius: 50%; border: 1px solid #333;"></div>
              <div class="legend-text">照明（点灯）</div>
            </div>
            <div class="legend-item">
              <div style="width: 20px; height: 20px; background-color: #f0f0f0; border-radius: 50%; border: 1px solid #333;"></div>
              <div class="legend-text">照明（消灯）</div>
            </div>
          </div>
        </section>
      </div>
    </div>
    
    <!-- コンセント回路セクション -->
    <div id="outletSection" class="section-container">
      <div class="circuit-container">
        <section class="circuit" id="charging-outlet">
          <div class="circuit-title">
            <h2>コンセント回路</h2>
            <div class="circuit-status" id="chargingStatus">切断</div>
          </div>
          <div class="circuit-content larger">
            <svg class="circuit-svg" viewBox="0 0 1000 600" xmlns="http://www.w3.org/2000/svg">
              <!-- ラベル -->
              <text x="80" y="50" font-family="sans-serif" font-size="24" font-weight="bold">0V[接地]</text>
              <text x="30" y="100" font-family="sans-serif" font-size="24" font-weight="bold">100V[非接地]</text>
              
              <!-- 配線 -->
              <path d="M 200 50 L 650 50 L 650 180" stroke="#AAAAAA" stroke-width="8" fill="none" class="w-wire"/>
              <path d="M 200 100 L 550 100 L 550 180" stroke="#333" stroke-width="8" fill="none" class="b-wire"/>
              
              <!-- 電流の流れアニメーション（初期状態では非表示） -->
              <path d="M 200 100 L 550 100 L 550 400 L 650 400 L 650 50 L 200 50" 
                    stroke="#FF961C" stroke-width="4" fill="none" opacity="0" id="current" class="current-path"/>
              
              <!-- コンセント本体 -->
              <rect x="500" y="180" width="200" height="300" rx="20" fill="white" stroke="black" stroke-width="4"/>
              
              <!-- 空のソケット - 未接続時のみ表示 -->
              <g id="emptySocket">
                <!-- 上部ソケット -->
                <rect x="550" y="230" width="100" height="60" rx="15" fill="white" stroke="black" stroke-width="3"/>
                <rect x="575" y="245" width="10" height="30" fill="black"/>
                <rect x="615" y="245" width="10" height="30" fill="black"/>
                
                <!-- 下部ソケット -->
                <rect x="550" y="370" width="100" height="60" rx="15" fill="white" stroke="black" stroke-width="3"/>
                <rect x="575" y="385" width="10" height="30" fill="black"/>
                <rect x="615" y="385" width="10" height="30" fill="black"/>
              </g>

              <!-- コンセント（プラグ接続時用） - 初期表示 -->
              <g id="pluggedOutlet" style="display: none;">
                <!-- 上部ソケット -->
                <rect x="550" y="230" width="100" height="60" rx="15" fill="white" stroke="black" stroke-width="3"/>
                <rect x="575" y="245" width="10" height="30" fill="black"/>
                <rect x="615" y="245" width="10" height="30" fill="black"/>
                
                <!-- 下部ソケット（プラグ挿入済み） -->
                <rect x="550" y="370" width="100" height="60" rx="15" fill="white" stroke="black" stroke-width="3"/>
                
                <!-- プラグ（下部ソケットに挿入済み） -->
                <g transform="translate(600, 410)">
                  <!-- プラグ本体 -->
                  <rect x="-40" y="0" width="80" height="120" rx="5" fill="#AAAAAA" stroke="black" stroke-width="2"/>
                  <!-- プラグ本体の接続部分 -->
                  <rect x="-50" y="-10" width="100" height="20" rx="3" fill="#777" stroke="black" stroke-width="2"/>
                  <!-- プラグ内部 -->
                  <rect x="-25" y="35" width="50" height="70" fill="#666"/>
                  <circle cx="-5" cy="80" r="10" fill="#888"/>
                  <circle cx="10" cy="65" r="10" fill="#888"/>
                  <!-- コード -->
                  <rect x="-10" y="120" width="20" height="40" fill="#999"/>
                </g>
              </g>
              
              <!-- バッテリー -->
              <g id="battery" transform="translate(900, 330)">
                <!-- バッテリー外枠 -->
                <rect x="-60" y="-40" width="120" height="80" rx="10" fill="white" stroke="black" stroke-width="3"/>
                
                <!-- バッテリー端子 -->
                <rect x="60" y="-15" width="10" height="30" rx="2" fill="white" stroke="black" stroke-width="2"/>
                
                <!-- 初期状態：低充電 -->
                <rect x="-50" y="-30" width="35" height="60" fill="black" id="batteryLevel"/>
                
                <!-- 充電マーク（稲妻）- 初期状態では非表示 -->
                <g id="chargingSymbol" opacity="0">
                  <path d="M 20 -30 L -20 5 L 5 5 L -15 30" stroke="#FFA500" stroke-width="12" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M 20 -30 L -20 5 L 5 5 L -15 30" stroke="#FFD700" stroke-width="6" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
                </g>
              </g>
              
              <!-- プラグ - 未接続状態 -->
              <g id="disconnectedPlug" class="interactive-element">
                <!-- ブレード部分 -->
                <rect x="280" y="290" width="10" height="60" rx="0" fill="black"/>
                <rect x="310" y="290" width="10" height="60" rx="0" fill="black"/>
                
                <!-- プラグ本体 -->
                <rect x="260" y="340" width="80" height="120" rx="5" fill="#AAAAAA" stroke="black" stroke-width="2"/>
                
                <!-- プラグ本体の接続部分 -->
                <rect x="250" y="330" width="100" height="20" rx="3" fill="#777" stroke="black" stroke-width="2"/>
                
                <!-- プラグ内部 -->
                <rect x="275" y="375" width="50" height="70" fill="#666"/>
                <circle cx="295" cy="420" r="10" fill="#888"/>
                <circle cx="310" cy="405" r="10" fill="#888"/>
                
                <!-- コード -->
                <rect x="290" y="460" width="20" height="40" fill="#999"/>
              </g>
            </svg>
          </div>
          <div class="measurement-display">
            <div class="meter">
              <span class="meter-label">電圧:</span>
              <span class="meter-value" id="outletVoltage">0 V</span>
            </div>
            <div class="meter">
              <span class="meter-label">電流:</span>
              <span class="meter-value" id="outletCurrent">0.0 A</span>
            </div>
            <div class="meter">
              <span class="meter-label">充電状態:</span>
              <span class="meter-value" id="chargingState">30%</span>
            </div>
          </div>
          <div class="circuit-description">
            コンセント回路では、プラグをコンセントに差し込むと電流が流れます。プラグの栓刃を経由して接続機器に電気が通電します。プラグをクリックすると接続・切断が切り替わります。
            <button class="help-tip" data-tip="コンセントの定格は一般的に15Aまでです。複数の電気機器を同時に使用する場合は、合計の消費電流に注意が必要です。">?</button>
          </div>
          <button id="toggleButton" class="button">プラグを挿入/取り外し</button>
          <button id="resetChargingButton" class="button" style="background-color: var(--accent-color); margin-left: 10px;">充電状態をリセット</button>
          
          <div class="safety-notice">
            <div class="safety-title"><span class="safety-icon">⚠️</span> 安全に関する注意</div>
            <p>コンセントの使用時は以下の点に注意してください：</p>
            <ul>
              <li>定格容量（一般的に15A・1500Wまで）を超える機器を接続しない</li>
              <li>たこ足配線を避け、大電力機器は専用回路を使用する</li>
              <li>プラグの抜き差しは必ずプラグ本体を持って行う</li>
            </ul>
          </div>
        </section>
        
        <section class="legend">
          <h2>凡例</h2>
          <div class="legend-items">
            <div class="legend-item">
              <div class="legend-color w-color"></div>
              <div class="legend-text">白線 (接地側) - 0V</div>
            </div>
            <div class="legend-item">
              <div class="legend-color b-color"></div>
              <div class="legend-text">黒線 (非接地側) - 100V</div>
            </div>
            <div class="legend-item">
              <div class="legend-color" style="background-color: #FF961C;"></div>
              <div class="legend-text">電流の流れ</div>
            </div>
            <div class="legend-item">
              <div style="width: 20px; height: 20px; border-radius: 50%; background: linear-gradient(to right, black 30%, white 30%);"></div>
              <div class="legend-text">低充電バッテリー</div>
            </div>
            <div class="legend-item">
              <div style="width: 20px; height: 20px; border-radius: 50%; background: black;"></div>
              <div class="legend-text">充電済みバッテリー</div>
            </div>
          </div>
        </section>
      </div>
    </div>
    
    <!-- トラブルシューティングセクション -->
    <div id="troubleSection" class="section-container">
      <div class="panel">
        <div class="panel-title">トラブルシューティング演習</div>
        <p>以下の故障ケースを解析し、問題の原因を特定して修復する手順を学びましょう。</p>
        
        <div class="circuit">
          <div class="circuit-title">
            <h2>故障ケース1: 片切スイッチの照明が点灯しない</h2>
          </div>
          <div class="circuit-content">
            <svg class="circuit-svg" viewBox="0 0 800 200" xmlns="http://www.w3.org/2000/svg">
              <!-- 故障した回路の図 -->
              <text x="30" y="50" class="label">0V[接地]</text>
              <text x="1" y="150" class="label">100V[非接地]</text>
              
              <path d="M 100 50 L 400 50 L 400 100" stroke="#AAAAAA" stroke-width="3" fill="none" class="w-wire"/>
              
              <path d="M 100 150 L 200 150" stroke="#333" stroke-width="3" fill="none" class="b-wire"/>
              <path d="M 300 150 L 400 150 L 400 120" stroke="#333" stroke-width="3" fill="none" class="b-wire"/>
              
              <g id="brokenSwitch">
                <rect x="200" y="130" width="100" height="40" fill="white" stroke="#333" stroke-width="2" rx="5"/>
                <line x1="200" y1="150" x2="220" y2="150" stroke="#333" stroke-width="3"/>
                <line x1="280" y1="150" x2="300" y2="150" stroke="#333" stroke-width="3"/>
                <line x1="220" y1="150" x2="280" y2="130" stroke="#333" stroke-width="3" stroke-dasharray="5,5"/>
                <circle cx="220" cy="150" r="4" fill="#333"/>
                <circle cx="280" cy="150" r="4" fill="#333"/>
                <text x="250" y="120" text-anchor="middle" font-size="12">故障したスイッチ</text>
              </g>
              
              <circle cx="400" cy="110" r="20" fill="#f0f0f0" stroke="#333" stroke-width="2"/>
              <text x="400" y="115" text-anchor="middle" font-size="11">照明</text>
            </svg>
          </div>
          
          <div class="troubleshooting-panel">
            <div class="problem-desc">症状: スイッチをONにしても照明が点灯しません。考えられる原因を調査してください。</div>
            
            <div class="checklist">
              <li><input type="checkbox" id="check1"> <label for="check1">ブレーカーが落ちていないか確認する</label></li>
              <li><input type="checkbox" id="check2"> <label for="check2">電球が切れていないか確認する</label></li>
              <li><input type="checkbox" id="check3"> <label for="check3">スイッチの接点を確認する</label></li>
              <li><input type="checkbox" id="check4"> <label for="check4">配線の接続を確認する</label></li>
            </div>
            
            <button class="hint-btn" id="troubleHint1">ヒントを表示</button>
            <button class="solution-btn" id="troubleSolution1">解決策を表示</button>
            
            <div id="hint1" style="display: none; margin-top: 10px; padding: 10px; background-color: #f0f8ff; border-left: 4px solid #4D8BC9;">
              ヒント: 点線で表示されているスイッチの接点部分に注目してください。スイッチの接点が正しく接触していないようです。
            </div>
            
            <div id="solution1" style="display: none; margin-top: 10px; padding: 10px; background-color: #f0fff0; border-left: 4px solid #28a745;">
              解決策: <br>
              1. スイッチの接点が摩耗または破損しています。<br>
              2. スイッチを新品に交換します。<br>
              3. 交換前に必ずブレーカーを落として安全を確保してください。<br>
              4. 交換後、正常に動作するか確認します。
            </div>
          </div>
        </div>
        
        <div class="circuit">
          <div class="circuit-title">
            <h2>故障ケース2: 3路スイッチが正常に動作しない</h2>
          </div>
          <div class="circuit-content">
            <svg class="circuit-svg" viewBox="0 0 900 200" xmlns="http://www.w3.org/2000/svg">
              <!-- 故障した3路スイッチ回路の図 -->
              <text x="20" y="50" class="label">0V[接地]</text>
              <text x="1" y="150" class="label">100V[非接地]</text>
              
              <path d="M 80 50 L 650 50 L 650 100" stroke="#AAAAAA" stroke-width="3" fill="none" class="w-wire"/>
              
              <path d="M 80 150 L 150 150" stroke="#333" stroke-width="3" fill="none" class="b-wire"/>
              
              <g id="threeWaySwitch1Normal">
                <rect x="150" y="130" width="70" height="60" fill="white" stroke="#333" stroke-width="2" rx="5"/>
                <line x1="150" y1="150" x2="170" y2="150" stroke="#333" stroke-width="3"/>
                <circle cx="170" cy="150" r="4" fill="#333"/>
                <circle cx="200" cy="140" r="4" fill="#333"/>
                <circle cx="200" cy="160" r="4" fill="#333"/>
                <line x1="170" y1="150" x2="200" y2="140" stroke="#333" stroke-width="3"/>
                <text x="185" y="120" text-anchor="middle" font-size="12">正常</text>
              </g>
              
              <path d="M 200 140 L 390 140" stroke="#FF0000" stroke-width="3" fill="none" class="r-wire" stroke-dasharray="5,5"/>
              <path d="M 200 160 L 390 160" stroke="#FF0000" stroke-width="3" fill="none" class="r-wire"/>
              
              <g id="threeWaySwitch2Normal">
                <rect x="390" y="130" width="70" height="60" fill="white" stroke="#333" stroke-width="2" rx="5"/>
                <circle cx="390" cy="140" r="4" fill="#333"/>
                <circle cx="390" cy="160" r="4" fill="#333"/>
                <circle cx="440" cy="150" r="4" fill="#333"/>
                <line x1="390" y1="140" x2="440" y2="150" stroke="#333" stroke-width="3"/>
                <line x1="440" y1="150" x2="460" y2="150" stroke="#333" stroke-width="3"/>
                <text x="425" y="120" text-anchor="middle" font-size="12">正常</text>
              </g>
              
              <path d="M 460 150 L 650 150 L 650 120" stroke="#333" stroke-width="3" fill="none" class="b-wire"/>
              
              <circle cx="650" cy="110" r="20" fill="#f0f0f0" stroke="#333" stroke-width="2"/>
              <text x="650" y="115" text-anchor="middle" font-size="12">照明</text>
              
              <rect x="290" y="117" width="70" height="18" fill="#FFCCCC" opacity="0.8" rx="3"></rect>
              <text x="325" y="130" text-anchor="middle" font-size="12" fill="red">断線！</text>
            </svg>
          </div>
          
          <div class="troubleshooting-panel">
            <div class="problem-desc">症状: 3路スイッチの片方を操作しても照明が点灯しないケースがあります。何が問題でしょうか？</div>
            
            <div class="checklist">
              <li><input type="checkbox" id="check5"> <label for="check5">両方のスイッチの動作を確認する</label></li>
              <li><input type="checkbox" id="check6"> <label for="check6">トラベラー線（赤線）の接続を確認する</label></li>
              <li><input type="checkbox" id="check7"> <label for="check7">照明器具の状態を確認する</label></li>
              <li><input type="checkbox" id="check8"> <label for="check8">配線の導通テストを行う</label></li>
            </div>
            
            <button class="hint-btn" id="troubleHint2">ヒントを表示</button>
            <button class="solution-btn" id="troubleSolution2">解決策を表示</button>
            
            <div id="hint2" style="display: none; margin-top: 10px; padding: 10px; background-color: #f0f8ff; border-left: 4px solid #4D8BC9;">
              ヒント: 図の上部のトラベラー線（赤線）に注目してください。点線で表示されているのは断線を示しています。
            </div>
            
            <div id="solution2" style="display: none; margin-top: 10px; padding: 10px; background-color: #f0fff0; border-left: 4px solid #28a745;">
              解決策: <br>
              1. 上部のトラベラー線（赤線）が断線しています。<br>
              2. 断線箇所を特定し、配線を新しいものに交換します。<br>
              3. 壁内配線の交換が難しい場合は、電気工事士に依頼してください。<br>
              4. 交換後、両方のスイッチで正常に操作できるか確認します。
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- 安全情報セクション -->
    <div id="safetySection" class="section-container">
      <div class="panel">
        <div class="panel-title">電気工事の安全基準</div>
        <p>電気設備工事を行う際は、「電気設備技術基準」および「内線規程」に基づいた安全な施工が求められます。</p>
        
        <div class="safety-notice">
          <div class="safety-title"><span class="safety-icon">⚠️</span> 電気工事士資格の必要性</div>
          <p>電気工事は「電気工事士法」により、有資格者（第一種・第二種電気工事士）が行うことが法律で定められています。無資格での電気工事は違法であり、罰則の対象となります。</p>
        </div>
        
        <h3 style="margin-top: 20px; color: var(--corporate-color);">感電防止の基本</h3>
        <ul>
          <li>作業前に必ず該当する回路のブレーカーを切る</li>
          <li>電圧検電器で通電していないことを確認する</li>
          <li>絶縁手袋や絶縁工具を適切に使用する</li>
          <li>濡れた手や濡れた床での作業は避ける</li>
        </ul>
        
        <h3 style="margin-top: 20px; color: var(--corporate-color);">火災防止のポイント</h3>
        <ul>
          <li>配線は定格電流に適した太さを選定する</li>
          <li>接続部は確実に締め付け、緩みがないようにする</li>
          <li>引火性物質の近くでの作業は避ける</li>
          <li>配線の束ね過ぎによる発熱を防止する</li>
        </ul>
        
        <h3 style="margin-top: 20px; color: var(--corporate-color);">緊急時の対応</h3>
        <ol>
          <li>感電者を発見した場合：
            <ul>
              <li>まず電源を切るか、絶縁物を使って感電者を電源から引き離す</li>
              <li>意識・呼吸を確認し、必要に応じて救急車を呼ぶ（119番）</li>
            </ul>
          </li>
          <li>電気火災の場合：
            <ul>
              <li>可能であれば電源を遮断する</li>
              <li>消火器（電気火災用）を使用する</li>
              <li>水は使わない（感電の危険性があるため）</li>
            </ul>
          </li>
        </ol>
      </div>
      
      <div class="panel">
        <div class="panel-title">保守点検のポイント</div>
        <p>定期的な点検により、事故を未然に防ぎ、設備の長寿命化を図ることができます。</p>
        
        <h3 style="margin-top: 20px; color: var(--corporate-color);">日常点検項目</h3>
        <div class="checklist">
          <li><input type="checkbox"> <label>スイッチの動作音や感触に異常がないか</label></li>
          <li><input type="checkbox"> <label>コンセントにガタつきやひび割れがないか</label></li>
          <li><input type="checkbox"> <label>異常な発熱や焦げた臭いがしないか</label></li>
          <li><input type="checkbox"> <label>漏電遮断器のテストボタンが正常に動作するか</label></li>
        </div>
        
        <h3 style="margin-top: 20px; color: var(--corporate-color);">定期点検項目（専門家による点検）</h3>
        <div class="checklist">
          <li><input type="checkbox"> <label>配線の絶縁抵抗測定</label></li>
          <li><input type="checkbox"> <label>端子の緩みや接触不良のチェック</label></li>
          <li><input type="checkbox"> <label>アース（接地）抵抗の測定</label></li>
          <li><input type="checkbox"> <label>配電盤内部の点検・清掃</label></li>
        </div>
      </div>
    </div>
    
    <!-- 理解度チェックセクション -->
    <div id="quizSection" class="section-container">
      <div class="panel">
        <div class="panel-title">理解度チェック</div>
        <p>以下の問題に回答して、学習内容の理解度をチェックしましょう。</p>
        
        <div class="quiz-container">
          <div class="quiz-question">1. 片切スイッチは何箇所から照明を操作できますか？</div>
          <ul class="quiz-options">
            <li><input type="radio" name="q1" id="q1a" value="a"> <label for="q1a">1箇所</label></li>
            <li><input type="radio" name="q1" id="q1b" value="b"> <label for="q1b">2箇所</label></li>
            <li><input type="radio" name="q1" id="q1c" value="c"> <label for="q1c">3箇所</label></li>
            <li><input type="radio" name="q1" id="q1d" value="d"> <label for="q1d">4箇所</label></li>
          </ul>
          
          <div class="quiz-question">2. 3路スイッチ回路で特徴的な配線は次のうちどれですか？</div>
          <ul class="quiz-options">
            <li><input type="radio" name="q2" id="q2a" value="a"> <label for="q2a">白線（W）</label></li>
            <li><input type="radio" name="q2" id="q2b" value="b"> <label for="q2b">黒線（B）</label></li>
            <li><input type="radio" name="q2" id="q2c" value="c"> <label for="q2c">赤線（R）/トラベラー線</label></li>
            <li><input type="radio" name="q2" id="q2d" value="d"> <label for="q2d">緑線（接地線）</label></li>
          </ul>
          
          <div class="quiz-question">3. 3路+4路スイッチ回路は、何箇所から照明を操作できますか？</div>
          <ul class="quiz-options">
            <li><input type="radio" name="q3" id="q3a" value="a"> <label for="q3a">2箇所</label></li>
            <li><input type="radio" name="q3" id="q3b" value="b"> <label for="q3b">3箇所</label></li>
            <li><input type="radio" name="q3" id="q3c" value="c"> <label for="q3c">4箇所</label></li>
            <li><input type="radio" name="q3" id="q3d" value="d"> <label for="q3d">無制限</label></li>
          </ul>
          
          <div class="quiz-question">4. 電気工事を行える資格者は誰ですか？</div>
          <ul class="quiz-options">
            <li><input type="radio" name="q4" id="q4a" value="a"> <label for="q4a">誰でも可能</label></li>
            <li><input type="radio" name="q4" id="q4b" value="b"> <label for="q4b">電気工事士（第一種・第二種）の資格保有者</label></li>
            <li><input type="radio" name="q4" id="q4c" value="c"> <label for="q4c">建築士</label></li>
            <li><input type="radio" name="q4" id="q4d" value="d"> <label for="q4d">消防設備士</label></li>
          </ul>
          
          <div class="quiz-question">5. 一般住宅のコンセント回路の定格電流は一般的に何アンペアですか？</div>
          <ul class="quiz-options">
            <li><input type="radio" name="q5" id="q5a" value="a"> <label for="q5a">5A</label></li>
            <li><input type="radio" name="q5" id="q5b" value="b"> <label for="q5b">10A</label></li>
            <li><input type="radio" name="q5" id="q5c" value="c"> <label for="q5c">15A</label></li>
            <li><input type="radio" name="q5" id="q5d" value="d"> <label for="q5d">30A</label></li>
          </ul>
          
          <button class="check-answer-btn" id="checkAnswersBtn">回答を確認</button>
          <div id="quizResults" style="margin-top: 15px; display: none;"></div>
        </div>
      </div>
    </div>
  </main>
  
  <footer class="footer">
    <div>電気技術研修資料</div>
    <div class="page-number">1</div>
  </footer>
  
  <!-- ツールチップ用 -->
  <div class="tooltip" id="tooltip"></div>
  
  <script>
    // ページ読み込み時に実行
    document.addEventListener('DOMContentLoaded', function() {
      // ヘルプチップ機能
      const helpTips = document.querySelectorAll('.help-tip');
      const tooltip = document.getElementById('tooltip');
      
      helpTips.forEach(tip => {
        tip.addEventListener('mouseenter', (e) => {
          const tipText = tip.getAttribute('data-tip');
          tooltip.textContent = tipText;
          tooltip.style.display = 'block';
          tooltip.style.left = (e.pageX + 10) + 'px';
          tooltip.style.top = (e.pageY + 10) + 'px';
        });
        
        tip.addEventListener('mouseleave', () => {
          tooltip.style.display = 'none';
        });
      });
      
      // トラブルシューティングのヒント・解決策表示
      document.getElementById('troubleHint1').addEventListener('click', () => {
        document.getElementById('hint1').style.display = 'block';
      });
      
      document.getElementById('troubleSolution1').addEventListener('click', () => {
        document.getElementById('solution1').style.display = 'block';
      });
      
      document.getElementById('troubleHint2').addEventListener('click', () => {
        document.getElementById('hint2').style.display = 'block';
      });
      
      document.getElementById('troubleSolution2').addEventListener('click', () => {
        document.getElementById('solution2').style.display = 'block';
      });
      
      // クイズの回答チェック
      document.getElementById('checkAnswersBtn').addEventListener('click', () => {
        const answers = {
          q1: 'a', // 1箇所
          q2: 'c', // 赤線（R）/トラベラー線
          q3: 'b', // 3箇所
          q4: 'b', // 電気工事士
          q5: 'c'  // 15A
        };
        
        let score = 0;
        let results = '<h3>結果</h3>';
        
        for (const q in answers) {
          const selectedAnswer = document.querySelector(`input[name="${q}"]:checked`);
          
          if (selectedAnswer) {
            if (selectedAnswer.value === answers[q]) {
              score++;
              results += `<p>問${q.substring(1)}: ✓ 正解！</p>`;
            } else {
              results += `<p>問${q.substring(1)}: ✗ 不正解</p>`;
            }
          } else {
            results += `<p>問${q.substring(1)}: 未回答</p>`;
          }
        }
        
        results += `<p>スコア: ${score}/${Object.keys(answers).length}</p>`;
        
        if (score === Object.keys(answers).length) {
          results += '<p style="color: green; font-weight: bold;">おめでとうございます！全問正解です。</p>';
        } else if (score >= Object.keys(answers).length * 0.8) {
          results += '<p style="color: blue; font-weight: bold;">よくできました！</p>';
        } else if (score >= Object.keys(answers).length * 0.6) {
          results += '<p style="color: orange;">もう少し！再度学習内容を確認しましょう。</p>';
        } else {
          results += '<p style="color: red;">各セクションをもう一度復習しましょう。</p>';
        }
        
        document.getElementById('quizResults').innerHTML = results;
        document.getElementById('quizResults').style.display = 'block';
      });
      
      // ナビゲーションメニュー切り替え
      const navItems = document.querySelectorAll('.nav-item');
      navItems.forEach(item => {
        item.addEventListener('click', () => {
          // アクティブなナビアイテムを更新
          navItems.forEach(navItem => navItem.classList.remove('active'));
          item.classList.add('active');
          
          // セクションの切り替え
          const sectionId = item.getAttribute('data-section');
          document.querySelectorAll('.section-container').forEach(section => {
            section.classList.remove('active');
          });
          document.getElementById(sectionId + 'Section').classList.add('active');
        });
      });
      
      // ---- スイッチ回路のスクリプト ----
      // シングルスイッチの要素取得
      const singleSwitch = document.getElementById('singleSwitch');
      const singleSwitchLine = document.getElementById('singleSwitchLine');
      const singleSwitchLamp = document.getElementById('singleSwitchLamp');
      const singleSwitchStatus = document.getElementById('singleSwitchStatus');
      const singleSwitchCurrent = document.getElementById('singleSwitchCurrent');
      const singleSwitchVoltage = document.getElementById('singleSwitchVoltage');
      const singleSwitchCurrentValue = document.getElementById('singleSwitchCurrent');
      const singleSwitchPower = document.getElementById('singleSwitchPower');
      
      // 3路スイッチの要素取得
      const threeWaySwitch1 = document.getElementById('threeWaySwitch1');
      const threeWaySwitch2 = document.getElementById('threeWaySwitch2');
      const threeWaySwitch1Line = document.getElementById('threeWaySwitch1Line');
      const threeWaySwitch2Line = document.getElementById('threeWaySwitch2Line');
      const threeWaySwitchLamp = document.getElementById('threeWaySwitchLamp');
      const threeWaySwitchStatus = document.getElementById('threeWaySwitchStatus');
      const threeWaySwitchCurrent = document.getElementById('threeWaySwitchCurrent');
      const threeWaySwitchVoltage = document.getElementById('threeWaySwitchVoltage');
      const threeWaySwitchCurrentValue = document.getElementById('threeWaySwitchCurrentValue');
      const threeWaySwitchPower = document.getElementById('threeWaySwitchPower');
      
      // 4路スイッチの要素取得
      const fourWaySwitch1 = document.getElementById('fourWaySwitch1');
      const fourWayMiddleSwitch = document.getElementById('fourWayMiddleSwitch');
      const fourWaySwitch2 = document.getElementById('fourWaySwitch2');
      const fourWaySwitch1Line = document.getElementById('fourWaySwitch1Line');
      const fourWayMiddleSwitch1 = document.getElementById('fourWayMiddleSwitch1');
      const fourWayMiddleSwitch2 = document.getElementById('fourWayMiddleSwitch2');
      const fourWaySwitch2Line = document.getElementById('fourWaySwitch2Line');
      const fourWaySwitchLamp = document.getElementById('fourWaySwitchLamp');
      const fourWaySwitchStatus = document.getElementById('fourWaySwitchStatus');
      const fourWaySwitchCurrent = document.getElementById('fourWaySwitchCurrent');
      const fourWaySwitchVoltage = document.getElementById('fourWaySwitchVoltage');
      const fourWaySwitchCurrentValue = document.getElementById('fourWaySwitchCurrentValue');
      const fourWaySwitchPower = document.getElementById('fourWaySwitchPower');
      
      // 状態変数
      let singleSwitchOn = false;
      let threeWaySwitch1On = false;
      let threeWaySwitch2On = false;
      let fourWaySwitch1On = false;
      let fourWayMiddleSwitchOn = false;
      let fourWaySwitch2On = false;
      
      // シングルスイッチクリックイベント
      if (singleSwitch) {
        singleSwitch.addEventListener('click', () => {
          singleSwitchOn = !singleSwitchOn;
          updateSingleSwitchState();
        });
      }
      
      // 3路スイッチクリックイベント
      if (threeWaySwitch1) {
        threeWaySwitch1.addEventListener('click', () => {
          threeWaySwitch1On = !threeWaySwitch1On;
          updateThreeWaySwitchState();
        });
      }
      
      if (threeWaySwitch2) {
        threeWaySwitch2.addEventListener('click', () => {
          threeWaySwitch2On = !threeWaySwitch2On;
          updateThreeWaySwitchState();
        });
      }
      
      // 4路スイッチクリックイベント
      if (fourWaySwitch1) {
        fourWaySwitch1.addEventListener('click', () => {
          fourWaySwitch1On = !fourWaySwitch1On;
          updateFourWaySwitchState();
        });
      }
      
      if (fourWayMiddleSwitch) {
        fourWayMiddleSwitch.addEventListener('click', () => {
          fourWayMiddleSwitchOn = !fourWayMiddleSwitchOn;
          updateFourWaySwitchState();
        });
      }
      
      if (fourWaySwitch2) {
        fourWaySwitch2.addEventListener('click', () => {
          fourWaySwitch2On = !fourWaySwitch2On;
          updateFourWaySwitchState();
        });
      }
      
      // シングルスイッチの状態更新
function updateSingleSwitchState() {
  if (singleSwitchOn) {
    // ON状態の場合
    singleSwitchLine.setAttribute('x1', '220');
    singleSwitchLine.setAttribute('y1', '150');
    singleSwitchLine.setAttribute('x2', '280');
    singleSwitchLine.setAttribute('y2', '150');
    singleSwitchLamp.setAttribute('fill', '#FFD700');
    singleSwitchStatus.textContent = 'ON';
    singleSwitchStatus.classList.add('on');
    singleSwitchCurrent.style.opacity = '1';
    
    // 電流値を直接更新（複数の方法を試しています）
    var currentMeter = document.getElementById('singleSwitchCurrent');
    if (currentMeter) currentMeter.textContent = '0.6 A';
    
    // セレクタで特定して更新
    var meterElements = document.querySelectorAll('.meter-value');
    meterElements.forEach(function(element) {
      if (element.id === 'singleSwitchCurrent') {
        element.textContent = '0.6 A';
      }
    });
    
    // 他のメーター値の更新
    singleSwitchVoltage.textContent = '100 V';
    singleSwitchPower.textContent = '60 W';
  } else {
    // OFF状態の場合 - 同様のアプローチで更新
    singleSwitchLine.setAttribute('x1', '220');
    singleSwitchLine.setAttribute('y1', '150');
    singleSwitchLine.setAttribute('x2', '280');
    singleSwitchLine.setAttribute('y2', '130');
    singleSwitchLamp.setAttribute('fill', '#f0f0f0');
    singleSwitchStatus.textContent = 'OFF';
    singleSwitchStatus.classList.remove('on');
    singleSwitchCurrent.style.opacity = '0';
    
    // 電流値を直接更新（複数の方法を試しています）
    var currentMeter = document.getElementById('singleSwitchCurrent');
    if (currentMeter) currentMeter.textContent = '0.0 A';
    
    // セレクタで特定して更新
    var meterElements = document.querySelectorAll('.meter-value');
    meterElements.forEach(function(element) {
      if (element.id === 'singleSwitchCurrent') {
        element.textContent = '0.0 A';
      }
    });
    
    // 他のメーター値の更新
    singleSwitchVoltage.textContent = '0 V';
    singleSwitchPower.textContent = '0 W';
  }
}
      
 // 3路スイッチの状態更新
function updateThreeWaySwitchState() {
  // 正しい3路スイッチのロジック：両方が同じ赤線に接続されているとき回路が完成
  // threeWaySwitchXOnがtrueのとき下側の赤線に接続、falseのとき上側の赤線に接続と想定
  const circuitComplete = (threeWaySwitch1On === threeWaySwitch2On);
  
  // スイッチ1の位置更新
  if (threeWaySwitch1On) {
    threeWaySwitch1Line.setAttribute('x1', '170');
    threeWaySwitch1Line.setAttribute('y1', '150');
    threeWaySwitch1Line.setAttribute('x2', '200');
    threeWaySwitch1Line.setAttribute('y2', '160');
  } else {
    threeWaySwitch1Line.setAttribute('x1', '170');
    threeWaySwitch1Line.setAttribute('y1', '150');
    threeWaySwitch1Line.setAttribute('x2', '200');
    threeWaySwitch1Line.setAttribute('y2', '140');
  }
  
  // スイッチ2の位置更新
  if (threeWaySwitch2On) {
    threeWaySwitch2Line.setAttribute('x1', '390');
    threeWaySwitch2Line.setAttribute('y1', '160');
    threeWaySwitch2Line.setAttribute('x2', '440');
    threeWaySwitch2Line.setAttribute('y2', '150');
  } else {
    threeWaySwitch2Line.setAttribute('x1', '390');
    threeWaySwitch2Line.setAttribute('y1', '140');
    threeWaySwitch2Line.setAttribute('x2', '440');
    threeWaySwitch2Line.setAttribute('y2', '150');
  }
  
  // 回路状態の更新
  if (circuitComplete) {
    // 回路が完成している場合（両方のスイッチが同じ側に接続）
    threeWaySwitchLamp.setAttribute('fill', '#FFD700');
    threeWaySwitchStatus.textContent = 'ON';
    threeWaySwitchStatus.classList.add('on');
    
    // 電流経路の更新 - 黒線から白線への流れを表現
    let pathData = "";
    
    if (threeWaySwitch1On && threeWaySwitch2On) {
      // 両方のスイッチがON（下側赤線）の場合
      pathData = "M 80 150 L 170 150 L 200 160 L 390 160 L 440 150 L 460 150 L 650 150 L 650 120 L 650 100 L 650 50 L 80 50";
    } else {
      // 両方のスイッチがOFF（上側赤線）の場合
      pathData = "M 80 150 L 170 150 L 200 140 L 390 140 L 440 150 L 460 150 L 650 150 L 650 120 L 650 100 L 650 50 L 80 50";
    }
    
    threeWaySwitchCurrent.setAttribute('d', pathData);
    threeWaySwitchCurrent.style.opacity = '1';
    
    // メーター値の更新
    threeWaySwitchVoltage.textContent = '100 V';
    threeWaySwitchCurrentValue.textContent = '0.6 A';
    threeWaySwitchPower.textContent = '60 W';
  } else {
    // 回路が切断されている場合（異なる側に接続）
    threeWaySwitchLamp.setAttribute('fill', '#f0f0f0');
    threeWaySwitchStatus.textContent = 'OFF';
    threeWaySwitchStatus.classList.remove('on');
    threeWaySwitchCurrent.style.opacity = '0'; // 電流アニメーションを非表示
    
    // メーター値の更新
    threeWaySwitchVoltage.textContent = '0 V';
    threeWaySwitchCurrentValue.textContent = '0.0 A';
    threeWaySwitchPower.textContent = '0 W';
  }
}

      
      // 4路スイッチの状態更新
      function updateFourWaySwitchState() {
        // 4路スイッチは、3路スイッチと4路スイッチのON/OFF状態によって動作
        // 状態の組み合わせ回数が奇数なら回路完成
        const switchCount = (fourWaySwitch1On ? 1 : 0) + (fourWayMiddleSwitchOn ? 1 : 0) + (fourWaySwitch2On ? 1 : 0);
        const circuitComplete = switchCount % 2 === 1;
        
        // スイッチ1の位置更新
        if (fourWaySwitch1On) {
          fourWaySwitch1Line.setAttribute('x1', '135');
          fourWaySwitch1Line.setAttribute('y1', '170');
          fourWaySwitch1Line.setAttribute('x2', '165');
          fourWaySwitch1Line.setAttribute('y2', '180');
        } else {
          fourWaySwitch1Line.setAttribute('x1', '135');
          fourWaySwitch1Line.setAttribute('y1', '170');
          fourWaySwitch1Line.setAttribute('x2', '165');
          fourWaySwitch1Line.setAttribute('y2', '160');
        }
        
        // 4路スイッチの位置更新
        if (fourWayMiddleSwitchOn) {
          // 平行接続
          fourWayMiddleSwitch1.setAttribute('x1', '250');
          fourWayMiddleSwitch1.setAttribute('y1', '160');
          fourWayMiddleSwitch1.setAttribute('x2', '350');
          fourWayMiddleSwitch1.setAttribute('y2', '160');
          
          fourWayMiddleSwitch2.setAttribute('x1', '250');
          fourWayMiddleSwitch2.setAttribute('y1', '180');
          fourWayMiddleSwitch2.setAttribute('x2', '350');
          fourWayMiddleSwitch2.setAttribute('y2', '180');
        } else {
          // 交差接続
          fourWayMiddleSwitch1.setAttribute('x1', '250');
          fourWayMiddleSwitch1.setAttribute('y1', '160');
          fourWayMiddleSwitch1.setAttribute('x2', '350');
          fourWayMiddleSwitch1.setAttribute('y2', '180');
          
          fourWayMiddleSwitch2.setAttribute('x1', '250');
          fourWayMiddleSwitch2.setAttribute('y1', '180');
          fourWayMiddleSwitch2.setAttribute('x2', '350');
          fourWayMiddleSwitch2.setAttribute('y2', '160');
        }
        
        // スイッチ2の位置更新
        if (fourWaySwitch2On) {
          fourWaySwitch2Line.setAttribute('x1', '435');
          fourWaySwitch2Line.setAttribute('y1', '180');
          fourWaySwitch2Line.setAttribute('x2', '475');
          fourWaySwitch2Line.setAttribute('y2', '170');
        } else {
          fourWaySwitch2Line.setAttribute('x1', '435');
          fourWaySwitch2Line.setAttribute('y1', '160');
          fourWaySwitch2Line.setAttribute('x2', '475');
          fourWaySwitch2Line.setAttribute('y2', '170');
        }
        
        // 回路状態の更新
        if (circuitComplete) {
          fourWaySwitchLamp.setAttribute('fill', '#FFD700');
          fourWaySwitchStatus.textContent = 'ON';
          fourWaySwitchStatus.classList.add('on');
          
          // 電流経路の更新（黒線から白線への流れに修正）
          let pathData = "";
          
          // スイッチ1の経路から始める（黒線側から）
          pathData = "M 70 170 L 135 170";
          
          // スイッチ1からの経路
          if (fourWaySwitch1On) {
            pathData += " L 165 180 ";
          } else {
            pathData += " L 165 160 ";
          }
          
          // 4路スイッチの経路
          if (fourWayMiddleSwitchOn) {
            if (fourWaySwitch1On) {
              pathData += "L 250 180 L 350 180 ";
            } else {
              pathData += "L 250 160 L 350 160 ";
            }
          } else {
            if (fourWaySwitch1On) {
              pathData += "L 250 180 L 350 160 ";
            } else {
              pathData += "L 250 160 L 350 180 ";
            }
          }
          
          // スイッチ2の経路
          pathData += "L 435 ";
          if (fourWaySwitch2On) {
            pathData += "180 ";
          } else {
            pathData += "160 ";
          }
          
          // 照明を通って白線（接地側）に流れる
          pathData += "L 475 170 L 495 170 L 730 170 L 730 120 L 730 100 L 730 50 L 70 50";
          
          fourWaySwitchCurrent.setAttribute('d', pathData);
          fourWaySwitchCurrent.style.opacity = '1';
          
          // メーター値の更新
          fourWaySwitchVoltage.textContent = '100 V';
          fourWaySwitchCurrentValue.textContent = '0.6 A';
          fourWaySwitchPower.textContent = '60 W';
        } else {
          fourWaySwitchLamp.setAttribute('fill', '#f0f0f0');
          fourWaySwitchStatus.textContent = 'OFF';
          fourWaySwitchStatus.classList.remove('on');
          fourWaySwitchCurrent.style.opacity = '0';
          
          // メーター値の更新
          fourWaySwitchVoltage.textContent = '0 V';
          fourWaySwitchCurrentValue.textContent = '0.0 A';
          fourWaySwitchPower.textContent = '0 W';
        }
      }
      
      // ---- コンセント回路のスクリプト ----
      // 要素の取得
      const disconnectedPlug = document.getElementById('disconnectedPlug');
      const pluggedOutlet = document.getElementById('pluggedOutlet');
      const emptySocket = document.getElementById('emptySocket');
      const battery = document.getElementById('battery');
      const batteryLevel = document.getElementById('batteryLevel');
      const chargingSymbol = document.getElementById('chargingSymbol');
      const chargingStatus = document.getElementById('chargingStatus');
      const current = document.getElementById('current');
      const toggleButton = document.getElementById('toggleButton');
      const resetChargingButton = document.getElementById('resetChargingButton');
      const outletVoltage = document.getElementById('outletVoltage');
      const outletCurrent = document.getElementById('outletCurrent');
      const chargingState = document.getElementById('chargingState');
      
      // 状態変数
      let plugConnected = false;
      let chargingLevel = 30; // 初期充電量（%）
      let chargingInterval;
      
      // プラグクリックイベント
      if (disconnectedPlug) {
        disconnectedPlug.addEventListener('click', toggleConnection);
      }
      
      if (toggleButton) {
        toggleButton.addEventListener('click', toggleConnection);
      }
      
      // 充電状態リセットボタン
      if (resetChargingButton) {
        resetChargingButton.addEventListener('click', resetCharging);
      }
      
      // 接続状態切り替え
      function toggleConnection() {
        plugConnected = !plugConnected;
        updateState();
        
        // 充電開始・停止の処理
        if (plugConnected) {
          startCharging();
          outletCurrent.textContent = '1.5 A'; // 重要：リセット後の電流値を1.5Aに設定
        } else {
          stopCharging();
        }
      }
      
      // 充電状態リセット
  function resetCharging() {
  // 一旦充電を停止
  stopCharging();
  
  // 充電レベルを初期値に戻す
  chargingLevel = 30;
  updateBatteryLevel();
  
  // 接続中の場合は充電を再開
  if (plugConnected) {
    // 重要：電流値を先に設定してから充電開始
    outletCurrent.textContent = '1.5 A';
    startCharging();
  }
}
      
      // 状態更新
      function updateState() {
        if (plugConnected) {
          // 接続状態
          disconnectedPlug.style.display = 'none';
          pluggedOutlet.style.display = 'block';
          emptySocket.style.display = 'none';
          chargingStatus.textContent = '充電中';
          chargingStatus.classList.add('on');
          current.style.opacity = '1';
          chargingSymbol.setAttribute('opacity', '1');
          
          // メーター値の更新
          outletVoltage.textContent = '100 V';
          outletCurrent.textContent = '1.5 A';
        } else {
          // 切断状態
          disconnectedPlug.style.display = 'block';
          pluggedOutlet.style.display = 'none';
          emptySocket.style.display = 'block';
          chargingStatus.textContent = '切断';
          chargingStatus.classList.remove('on');
          current.style.opacity = '0';
          chargingSymbol.setAttribute('opacity', '0');
          
          // メーター値の更新
          outletVoltage.textContent = '0 V';
          outletCurrent.textContent = '0.0 A';
        }
        
        // バッテリーレベルの表示更新
        updateBatteryLevel();
      }
      
      // バッテリー充電開始
      function startCharging() {
        chargingInterval = setInterval(() => {
          if (chargingLevel < 100) {
            chargingLevel += 1;
            updateBatteryLevel();
          } else {
            // 満充電になったら充電を停止
            clearInterval(chargingInterval);
            outletCurrent.textContent = '0.1 A'; // 満充電時は微小電流
          }
        }, 100); // 0.1秒ごとに1%増加
      }
      
      // バッテリー充電停止
      function stopCharging() {
        clearInterval(chargingInterval);
      }
      
      // バッテリーレベルの表示更新
      function updateBatteryLevel() {
        // バッテリーレベルに応じて黒い部分の幅を変更
        const width = (chargingLevel / 100) * 100; // 最大幅は100
        batteryLevel.setAttribute('width', width);
        
        // 充電状態の更新
        chargingState.textContent = chargingLevel + '%';
      }
      
      // デフォルト状態の設定 - 全てのスイッチをOFFに設定
      singleSwitchOn = false;
      threeWaySwitch1On = false;
      threeWaySwitch2On = true;
      fourWaySwitch1On = false;
      fourWayMiddleSwitchOn = false;
      fourWaySwitch2On = false;
      plugConnected = false;
      
      // 初期状態の更新
      if (singleSwitch) updateSingleSwitchState();
      if (threeWaySwitch1 && threeWaySwitch2) updateThreeWaySwitchState();
      if (fourWaySwitch1 && fourWayMiddleSwitch && fourWaySwitch2) updateFourWaySwitchState();
      if (disconnectedPlug && pluggedOutlet) updateState();
    });

    // ウィンドウサイズに応じた自動スケーリング
    function adjustScale() {
      const viewportWidth = window.innerWidth;
      const viewportHeight = window.innerHeight;
      
      // ビューポートサイズに基づいたフォントサイズの調整
      if (viewportWidth < 768) {
        document.documentElement.style.fontSize = '14px';
      } else if (viewportWidth < 992) {
        document.documentElement.style.fontSize = '15px';
      } else {
        document.documentElement.style.fontSize = '16px';
      }
      
      // SVG要素の自動調整
      const svgElements = document.querySelectorAll('.circuit-svg svg');
      svgElements.forEach(svg => {
        svg.style.width = '100%';
        svg.style.height = 'auto';
        svg.style.maxWidth = '100%';
      });
      
      // ヘッダーとフッターの高さ調整
      if (viewportHeight < 600) {
        document.documentElement.style.setProperty('--header-height', '40px');
        document.documentElement.style.setProperty('--footer-height', '30px');
      }
    }

    // 初期化時とリサイズ時に実行
    window.addEventListener('DOMContentLoaded', adjustScale);
    window.addEventListener('resize', adjustScale);
  </script>
</body>
</html>