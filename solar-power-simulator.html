<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>太陽光発電システムシミュレーター</title>
    <link rel="stylesheet" href="css/solar-power.css">
</head>
<body>
    <header>
        <h1>太陽光発電システムシミュレーター</h1>
        <div class="tab-navigation">
            <button class="tab-button active" data-tab="simulator">シミュレーター</button>
            <button class="tab-button" data-tab="glossary">用語と説明</button>
        </div>
    </header>
    
    <div class="container">
        <!-- シミュレータータブコンテンツ -->
        <div class="tab-content active" id="simulator-content">
            <div class="grid">
                <div>
                    <!-- 左側のパネル：設定 -->
                    <div class="panel">
                        <h2>モジュール・ストリング設定</h2>
                        <div class="form-group">
                            <label for="panelPower">パネル定格出力 (W): <span class="tooltip">ⓘ<span class="tooltiptext">単一パネルの最大発電能力（Watt）</span></span></label>
                            <input type="number" id="panelPower" min="100" max="1000" value="330">
                        </div>
                        
                        <div class="form-group">
                            <label for="panelEfficiency">パネル変換効率 (%): <span class="tooltip">ⓘ<span class="tooltiptext">太陽光をどれだけ電気エネルギーに変換できるか</span></span></label>
                            <input type="number" id="panelEfficiency" min="15" max="25" step="0.1" value="19.5">
                        </div>
                        
                        <div class="form-group">
                            <label for="panelCount">パネル枚数: <span class="tooltip">ⓘ<span class="tooltiptext">設置するパネルの総枚数</span></span></label>
                            <input type="number" id="panelCount" min="1" max="100" value="12">
                        </div>
                        
                        <div class="form-group">
                            <label for="stringCount">ストリング数: <span class="tooltip">ⓘ<span class="tooltiptext">パネルの直列接続のグループ数</span></span></label>
                            <input type="number" id="stringCount" min="1" max="10" value="3">
                        </div>
                        
                        <div id="stringConfigPanel" class="string-panel">
                            <!-- ストリング構成はJSで動的に生成 -->
                        </div>
                    </div>
                    
                    <div class="panel">
                        <h2>パワーコンディショナー設定</h2>
                        
                        <!-- 新規追加：パワコン台数設定 -->
                        <div class="form-group">
                            <label for="pcsCount">パワコン台数: <span class="tooltip">ⓘ<span class="tooltiptext">設置するパワーコンディショナーの台数</span></span></label>
                            <input type="number" id="pcsCount" min="1" max="10" value="1">
                            <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem; color: #666;">※ 容量が大きい場合は複数台設置することで効率的に発電できます</p>
                        </div>
                        
                        <!-- 追加: パワコン設定タブ -->
                        <div id="pcsTabsContainer">
                            <div class="pcs-tabs" id="pcsTabs">
                                <div class="pcs-tab active" data-pcs-index="0">パワコン 1</div>
                            </div>
                            
                            <div id="pcsTabContents">
                                <div class="pcs-tab-content active" data-pcs-index="0">
                                    <div class="form-group">
                                        <label for="pcsType-0">パワコンタイプ: <span class="tooltip">ⓘ<span class="tooltiptext">パワーコンディショナーの種類によって特性が異なります</span></span></label>
                                        <select id="pcsType-0" class="pcs-type-select" data-pcs-index="0">
                                            <option value="standard">標準型(ストリング型)</option>
                                            <option value="multi-string">マルチストリング型</option>
                                            <option value="hybrid">ハイブリッド型</option>
                                            <option value="micro">マイクロインバーター型</option>
                                        </select>
                                        <p id="pcsTypeDescription-0" class="pcs-type-description" style="margin: 0.5rem 0 0 0; font-size: 0.9rem; color: #666;">最も一般的なタイプ。1つのMPPT回路で全ストリングを制御</p>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="pcsRatedPower-0">定格出力 (kW): <span class="tooltip">ⓘ<span class="tooltiptext">パワコンが出力できる最大電力</span></span></label>
                                        <input type="number" id="pcsRatedPower-0" class="pcs-rated-power" data-pcs-index="0" min="1" max="50" step="0.1" value="5.5">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="pcsEfficiency-0">変換効率 (%): <span class="tooltip">ⓘ<span class="tooltiptext">DCからACへの変換効率</span></span></label>
                                        <input type="number" id="pcsEfficiency-0" class="pcs-efficiency" data-pcs-index="0" min="80" max="99" step="0.1" value="95.0">
                                    </div>
                                    
                                    <div id="mpptCountContainer-0" class="mppt-count-container form-group" style="display: none;">
                                        <label for="mpptCount-0">MPPT回路数: <span class="tooltip">ⓘ<span class="tooltiptext">Maximum Power Point Tracking回路の数。各ストリングを個別に最適制御できます。1台あたり最大4系統まで接続可能</span></span></label>
                                        <input type="number" id="mpptCount-0" class="mppt-count" data-pcs-index="0" min="1" max="4" value="1">
                                        <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem; color: #666;">※ MPPT回路数はストリング数以下である必要があります。</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 追加: 共通設定ボタン (複数台の場合) -->
                        <button id="applyCommonSettingsBtn" class="common-settings-btn" style="display: none;">すべてのパワコンに共通設定を適用</button>
                        
                        <!-- 複数パワコン時のストリング割り当て -->
                        <div id="stringAssignmentPanel" class="string-assignment-panel" style="display: none;">
                            <div class="string-assignment-title">ストリングの割り当て</div>
                            <div id="stringAssignmentGrid" class="string-assignment-grid">
                                <!-- 動的に生成 -->
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="useBooster">昇圧ユニット: <span class="tooltip">ⓘ<span class="tooltiptext">DC-DCコンバータで電圧を昇圧。低電圧システムで効率向上</span></span></label>
                            <div style="display: flex; align-items: center;">
                                <input type="checkbox" id="useBooster">
                                <span style="margin-left: 0.5rem;">使用する（DC-DCコンバータ）</span>
                            </div>
                            <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem; color: #666;">※ 低電圧システムで効率向上のために使用</p>
                            
                            <!-- 追加：昇圧ストリング選択パネル -->
                            <div id="boosterStringSelectionPanel" style="margin-top: 10px; padding: 10px; background-color: #f0f7ff; border-radius: 5px; display: none;">
                                <div style="font-weight: bold; margin-bottom: 8px; color: #005BAB;">昇圧するストリングを選択：</div>
                                <div id="boosterStringSelection" class="string-panel">
                                    <!-- チェックボックスはJSで動的に生成 -->
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="panel">
                        <h2>環境条件</h2>
                        <div class="form-group">
                            <label for="weatherCondition">天候条件: <span class="tooltip">ⓘ<span class="tooltiptext">日射量に影響する天候状態</span></span></label>
                            <select id="weatherCondition">
                                <option value="晴れ">晴れ</option>
                                <option value="薄曇り">薄曇り</option>
                                <option value="曇り">曇り</option>
                                <option value="雨">雨</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="temperature">周囲温度 (℃): <span class="tooltip">ⓘ<span class="tooltiptext">パネル周辺の気温。高温でパネル効率が低下</span></span></label>
                            <input type="range" id="temperature" min="-10" max="50" value="25" step="1">
                            <span id="temperatureValue" class="range-value">25℃</span>
                        </div>
                        
                        <div class="form-group">
                            <label for="tiltAngle">パネル傾斜角 (°): <span class="tooltip">ⓘ<span class="tooltiptext">地面に対するパネルの角度。30°前後が一般的に最適</span></span></label>
                            <input type="range" id="tiltAngle" min="0" max="90" value="30" step="1">
                            <span id="tiltAngleValue" class="range-value">30°</span>
                        </div>
                        
                        <div class="form-group">
                            <label for="orientationAngle">方位角 (°): <span class="tooltip">ⓘ<span class="tooltiptext">真南を0°として、東がマイナス、西がプラス</span></span></label>
                            <input type="range" id="orientationAngle" min="-90" max="90" value="0" step="1">
                            <span id="orientationAngleValue" class="range-value">0° (真南)</span>
                        </div>
                    </div>
                    
                    <button id="calculateBtn">シミュレーション実行</button>
                </div>
                
                <div>
                    <!-- 右側のパネル：結果 -->
                    <div class="panel results-panel">
                        <h2>シミュレーション結果</h2>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                            <div>
                                <h3 style="color: #005BAB; font-size: 1.1rem; margin-bottom: 0.5rem;">システム情報</h3>
                                <div class="result-item">
                                    <strong>システム容量:</strong>
                                    <span id="systemCapacity" class="result-value">-</span>
                                </div>
                                <div class="result-item">
                                    <strong>モジュール枚数:</strong>
                                    <span id="modulesCount" class="result-value">-</span>
                                </div>
                                <div class="result-item">
                                    <strong>ストリング数:</strong>
                                    <span id="stringsCount" class="result-value">-</span>
                                </div>
                                <div class="result-item">
                                    <strong>パワコン台数:</strong>
                                    <span id="powerConditionerCount" class="result-value">-</span>
                                </div>
                            </div>
                            
                            <div>
                                <h3 style="color: #005BAB; font-size: 1.1rem; margin-bottom: 0.5rem;">発電量予測</h3>
                                <div class="result-item">
                                    <strong>発電電力（瞬時）:</strong>
                                    <span id="instantPower" class="result-value">-</span>
                                </div>
                                <div class="result-item">
                                    <strong>日間発電量（推定）:</strong>
                                    <span id="dailyGeneration" class="result-value">-</span>
                                </div>
                                <div class="result-item">
                                    <strong>月間発電量（推定）:</strong>
                                    <span id="monthlyGeneration" class="result-value">-</span>
                                </div>
                                <div class="result-item">
                                    <strong>年間発電量（推定）:</strong>
                                    <span id="yearlyGeneration" class="result-value">-</span>
                                </div>
                            </div>
                            
                            <div>
                                <h3 style="color: #005BAB; font-size: 1.1rem; margin-bottom: 0.5rem;">各種効率係数</h3>
                                <div class="result-item">
                                    <strong>天候の影響:</strong>
                                    <span id="weatherFactor" class="result-value">-</span>
                                </div>
                                <div class="result-item">
                                    <strong>傾斜・方位角の影響:</strong>
                                    <span id="orientationFactor" class="result-value">-</span>
                                </div>
                                <div class="result-item">
                                    <strong>温度の影響:</strong>
                                    <span id="temperatureFactor" class="result-value">-</span>
                                </div>
                                <div class="result-item">
                                    <strong>システム効率:</strong>
                                    <span id="totalEfficiency" class="result-value">-</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- パワコン比較表 (複数台の場合) -->
                        <div id="pcsComparisonContainer" style="display: none; margin-top: 20px;">
                            <h3 style="color: #005BAB; font-size: 1.1rem; margin-bottom: 0.5rem;">パワーコンディショナー比較</h3>
                            <table class="pcs-comparison-table" id="pcsComparisonTable">
                                <thead>
                                    <tr>
                                        <th>パワコン</th>
                                        <th>タイプ</th>
                                        <th>定格出力</th>
                                        <th>変換効率</th>
                                        <th>接続ストリング</th>
                                        <th>発電量(kWh/日)</th>
                                        <th>使用率</th>
                                    </tr>
                                </thead>
                                <tbody id="pcsComparisonBody">
                                    <!-- 動的に生成 -->
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- グラフ表示部分 -->
                        <div class="charts-container">
                            <div class="chart-panel">
                                <h3>月別発電量予測</h3>
                                <canvas id="monthlyChart"></canvas>
                            </div>
                            <div class="chart-panel">
                                <h3>効率ロス分析</h3>
                                <canvas id="lossChart"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <!-- システム構成図 -->
                    <div class="panel">
                        <h2>システム構成図</h2>
                        
                        <!-- ①ソーラーパネル -->
                        <div id="solarPanelVisualization" class="system-diagram">
                            <h3 style="color: #005BAB; font-size: 1.1rem; margin-bottom: 1rem;">ソーラーパネル配置</h3>
                            <div id="panelGridContainer" class="solar-panel-grid">
                                <!-- ストリング1 -->
                                <div class="solar-panel-string" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 0.5rem; position: relative; margin-bottom: 15px;">
                                    <!-- PCS接続情報（位置修正） -->
                                    <div class="pcs-connection-info">
                                        → PCS 1 (標準型(ストリング型))
                                    </div>
                                    <!-- ストリング接続線 -->
                                    <div class="string-connection" style="position: absolute; top: 50%; left: 0; right: 0; 
                                         height: 3px; background-color: #FFD700; z-index: 1;"></div>
                                    
                                    <!-- パネル1-4 -->
                                    <div class="solar-panel-container">
                                        <svg width="100%" height="100%" viewBox="0 0 200 120" xmlns="http://www.w3.org/2000/svg">
                                            <rect class="module-frame" x="1.5" y="1.5" width="197" height="117" rx="3" ry="3" fill="none" stroke="#cccccc" stroke-width="3" />
                                            <rect class="module-background" x="3" y="3" width="194" height="114" rx="2" ry="2" fill="#002244" />
                                            <g>
                                                <rect x="50" y="50" width="100" height="20" fill="rgba(0,0,0,0.7)" rx="4" />
                                                <text x="100" y="65" text-anchor="middle" fill="white" font-size="14" font-weight="bold">100.0%</text>
                                            </g>
                                        </svg>
                                    </div>
                                    <div class="solar-panel-container">
                                        <svg width="100%" height="100%" viewBox="0 0 200 120" xmlns="http://www.w3.org/2000/svg">
                                            <rect class="module-frame" x="1.5" y="1.5" width="197" height="117" rx="3" ry="3" fill="none" stroke="#cccccc" stroke-width="3" />
                                            <rect class="module-background" x="3" y="3" width="194" height="114" rx="2" ry="2" fill="#002244" />
                                            <g>
                                                <rect x="50" y="50" width="100" height="20" fill="rgba(0,0,0,0.7)" rx="4" />
                                                <text x="100" y="65" text-anchor="middle" fill="white" font-size="14" font-weight="bold">100.0%</text>
                                            </g>
                                        </svg>
                                    </div>
                                    <div class="solar-panel-container">
                                        <svg width="100%" height="100%" viewBox="0 0 200 120" xmlns="http://www.w3.org/2000/svg">
                                            <rect class="module-frame" x="1.5" y="1.5" width="197" height="117" rx="3" ry="3" fill="none" stroke="#cccccc" stroke-width="3" />
                                            <rect class="module-background" x="3" y="3" width="194" height="114" rx="2" ry="2" fill="#002244" />
                                            <g>
                                                <rect x="50" y="50" width="100" height="20" fill="rgba(0,0,0,0.7)" rx="4" />
                                                <text x="100" y="65" text-anchor="middle" fill="white" font-size="14" font-weight="bold">100.0%</text>
                                            </g>
                                        </svg>
                                    </div>
                                    <div class="solar-panel-container">
                                        <svg width="100%" height="100%" viewBox="0 0 200 120" xmlns="http://www.w3.org/2000/svg">
                                            <rect class="module-frame" x="1.5" y="1.5" width="197" height="117" rx="3" ry="3" fill="none" stroke="#cccccc" stroke-width="3" />
                                            <rect class="module-background" x="3" y="3" width="194" height="114" rx="2" ry="2" fill="#002244" />
                                            <g>
                                                <rect x="50" y="50" width="100" height="20" fill="rgba(0,0,0,0.7)" rx="4" />
                                                <text x="100" y="65" text-anchor="middle" fill="white" font-size="14" font-weight="bold">100.0%</text>
                                            </g>
                                        </svg>
                                    </div>
                                </div>
                                
                                <!-- ストリング2 -->
                                <div class="solar-panel-string" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 0.5rem; position: relative; margin-bottom: 15px;">
                                    <!-- PCS接続情報（位置修正） -->
                                    <div class="pcs-connection-info">
                                        → PCS 1 (標準型(ストリング型))
                                    </div>
                                    <!-- ストリング接続線 -->
                                    <div class="string-connection" style="position: absolute; top: 50%; left: 0; right: 0; 
                                         height: 3px; background-color: #FFD700; z-index: 1;"></div>
                                    
                                    <!-- パネル1-4（2列目） -->
                                    <div class="solar-panel-container">
                                        <svg width="100%" height="100%" viewBox="0 0 200 120" xmlns="http://www.w3.org/2000/svg">
                                            <rect class="module-frame" x="1.5" y="1.5" width="197" height="117" rx="3" ry="3" fill="none" stroke="#cccccc" stroke-width="3" />
                                            <rect class="module-background" x="3" y="3" width="194" height="114" rx="2" ry="2" fill="#002244" />
                                            <g>
                                                <rect x="50" y="50" width="100" height="20" fill="rgba(0,0,0,0.7)" rx="4" />
                                                <text x="100" y="65" text-anchor="middle" fill="white" font-size="14" font-weight="bold">100.0%</text>
                                            </g>
                                        </svg>
                                    </div>
                                    <div class="solar-panel-container">
                                        <svg width="100%" height="100%" viewBox="0 0 200 120" xmlns="http://www.w3.org/2000/svg">
                                            <rect class="module-frame" x="1.5" y="1.5" width="197" height="117" rx="3" ry="3" fill="none" stroke="#cccccc" stroke-width="3" />
                                            <rect class="module-background" x="3" y="3" width="194" height="114" rx="2" ry="2" fill="#002244" />
                                            <g>
                                                <rect x="50" y="50" width="100" height="20" fill="rgba(0,0,0,0.7)" rx="4" />
                                                <text x="100" y="65" text-anchor="middle" fill="white" font-size="14" font-weight="bold">100.0%</text>
                                            </g>
                                        </svg>
                                    </div>
                                    <div class="solar-panel-container">
                                        <svg width="100%" height="100%" viewBox="0 0 200 120" xmlns="http://www.w3.org/2000/svg">
                                            <rect class="module-frame" x="1.5" y="1.5" width="197" height="117" rx="3" ry="3" fill="none" stroke="#cccccc" stroke-width="3" />
                                            <rect class="module-background" x="3" y="3" width="194" height="114" rx="2" ry="2" fill="#002244" />
                                            <g>
                                                <rect x="50" y="50" width="100" height="20" fill="rgba(0,0,0,0.7)" rx="4" />
                                                <text x="100" y="65" text-anchor="middle" fill="white" font-size="14" font-weight="bold">100.0%</text>
                                            </g>
                                        </svg>
                                    </div>
                                    <div class="solar-panel-container">
                                        <svg width="100%" height="100%" viewBox="0 0 200 120" xmlns="http://www.w3.org/2000/svg">
                                            <rect class="module-frame" x="1.5" y="1.5" width="197" height="117" rx="3" ry="3" fill="none" stroke="#cccccc" stroke-width="3" />
                                            <rect class="module-background" x="3" y="3" width="194" height="114" rx="2" ry="2" fill="#002244" />
                                            <g>
                                                <rect x="50" y="50" width="100" height="20" fill="rgba(0,0,0,0.7)" rx="4" />
                                                <text x="100" y="65" text-anchor="middle" fill="white" font-size="14" font-weight="bold">100.0%</text>
                                            </g>
                                        </svg>
                                    </div>
                                </div>
                                
                                <!-- ストリング3 -->
                                <div class="solar-panel-string" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 0.5rem; position: relative;">
                                    <!-- PCS接続情報（位置修正） -->
                                    <div class="pcs-connection-info">
                                        → PCS 1 (標準型(ストリング型))
                                    </div>
                                    <!-- ストリング接続線 -->
                                    <div class="string-connection" style="position: absolute; top: 50%; left: 0; right: 0; 
                                         height: 3px; background-color: #FFD700; z-index: 1;"></div>
                                    
                                    <!-- パネル1-4（3列目） -->
                                    <div class="solar-panel-container">
                                        <svg width="100%" height="100%" viewBox="0 0 200 120" xmlns="http://www.w3.org/2000/svg">
                                            <rect class="module-frame" x="1.5" y="1.5" width="197" height="117" rx="3" ry="3" fill="none" stroke="#cccccc" stroke-width="3" />
                                            <rect class="module-background" x="3" y="3" width="194" height="114" rx="2" ry="2" fill="#002244" />
                                            <g>
                                                <rect x="50" y="50" width="100" height="20" fill="rgba(0,0,0,0.7)" rx="4" />
                                                <text x="100" y="65" text-anchor="middle" fill="white" font-size="14" font-weight="bold">100.0%</text>
                                            </g>
                                        </svg>
                                    </div>
                                    <div class="solar-panel-container">
                                        <svg width="100%" height="100%" viewBox="0 0 200 120" xmlns="http://www.w3.org/2000/svg">
                                            <rect class="module-frame" x="1.5" y="1.5" width="197" height="117" rx="3" ry="3" fill="none" stroke="#cccccc" stroke-width="3" />
                                            <rect class="module-background" x="3" y="3" width="194" height="114" rx="2" ry="2" fill="#002244" />
                                            <g>
                                                <rect x="50" y="50" width="100" height="20" fill="rgba(0,0,0,0.7)" rx="4" />
                                                <text x="100" y="65" text-anchor="middle" fill="white" font-size="14" font-weight="bold">100.0%</text>
                                            </g>
                                        </svg>
                                    </div>
                                    <div class="solar-panel-container">
                                        <svg width="100%" height="100%" viewBox="0 0 200 120" xmlns="http://www.w3.org/2000/svg">
                                            <rect class="module-frame" x="1.5" y="1.5" width="197" height="117" rx="3" ry="3" fill="none" stroke="#cccccc" stroke-width="3" />
                                            <rect class="module-background" x="3" y="3" width="194" height="114" rx="2" ry="2" fill="#002244" />
                                            <g>
                                                <rect x="50" y="50" width="100" height="20" fill="rgba(0,0,0,0.7)" rx="4" />
                                                <text x="100" y="65" text-anchor="middle" fill="white" font-size="14" font-weight="bold">100.0%</text>
                                            </g>
                                        </svg>
                                    </div>
                                    <div class="solar-panel-container">
                                        <svg width="100%" height="100%" viewBox="0 0 200 120" xmlns="http://www.w3.org/2000/svg">
                                            <rect class="module-frame" x="1.5" y="1.5" width="197" height="117" rx="3" ry="3" fill="none" stroke="#cccccc" stroke-width="3" />
                                            <rect class="module-background" x="3" y="3" width="194" height="114" rx="2" ry="2" fill="#002244" />
                                            <g>
                                                <rect x="50" y="50" width="100" height="20" fill="rgba(0,0,0,0.7)" rx="4" />
                                                <text x="100" y="65" text-anchor="middle" fill="white" font-size="14" font-weight="bold">100.0%</text>
                                            </g>
                                        </svg>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ②アレイケーブル -->
                        <div id="arrayCableContainer" class="system-diagram" style="margin-top: 30px;">
                            <div class="diagram-container" style="text-align: center;">
                                <div class="component">
                                    <svg width="320" height="80" viewBox="0 0 160 40" xmlns="http://www.w3.org/2000/svg">

                                      <defs>
                                        <!-- オスコネクタ (MC4風、簡略版) - ケーブル接続側が x=0, y=0 -->
                                        <g id="mc4-male-connector">
                                          <rect class="connector-grip-male connector-grip" x="-6" y="-3.5" width="6" height="7" rx="1" ry="1"/>
                                          <rect class="connector-housing-male connector-housing" x="0" y="-4.5" width="10" height="9" rx="1.5" ry="1.5"/>
                                          <!-- ピン部分 -->
                                          <rect class="connector-insulator-male connector-insulator" x="9.5" y="-2.5" width="4.5" height="5" rx="0.8" ry="0.8"/>
                                          <circle class="connector-pin" cx="13.5" cy="0" r="0.8"/>
                                          <!-- ロック用クリップの溝 (簡易表現) -->
                                          <rect class="connector-lock-clip" x="2" y="-5.2" width="6" height="0.8" rx="0.3"/>
                                          <rect class="connector-lock-clip" x="2" y="4.4" width="6" height="0.8" rx="0.3"/>
                                        </g>

                                        <!-- メスコネクタ (MC4風、簡略版) - ケーブル接続側が x=0, y=0 -->
                                        <g id="mc4-female-connector">
                                          <rect class="connector-grip-female connector-grip" x="-7" y="-4.5" width="7" height="9" rx="1" ry="1"/>
                                          <rect class="connector-housing-female connector-housing" x="0" y="-5.5" width="12" height="11" rx="1.5" ry="1.5"/>
                                          <!-- ソケット部分 -->
                                          <rect class="connector-insulator-female connector-insulator" x="11.5" y="-3.5" width="4" height="7" rx="0.8" ry="0.8"/>
                                          <circle class="connector-socket-ring" cx="12.5" cy="0" r="1.6"/>
                                          <circle class="connector-socket-hole" cx="12.5" cy="0" r="1.0"/>
                                          <!-- ロック用クリップ (簡易表現) -->
                                          <rect class="connector-lock-clip" x="3" y="-2" width="1.2" height="4" rx="0.3"/>
                                          <rect class="connector-lock-clip" x="7.8" y="-2" width="1.2" height="4" rx="0.3"/>
                                        </g>
                                      </defs>

                                      <!-- ケーブルアセンブリ -->
                                      <g id="cable-assembly">
                                        <rect class="cable-sheath"
                                              x="20"
                                              y="17"
                                              width="119"
                                              height="6"
                                              rx="1.5" ry="1.5"/>

                                        <!-- 芯線 (2本) -->
                                        <rect class="cable-core-red"
                                              x="20.5"
                                              y="18"
                                              width="118"
                                              height="1.2"
                                              rx="0.5" ry="0.5"/>
                                        <rect class="cable-core-blue"
                                              x="20.5"
                                              y="19.8"
                                              width="118"
                                              height="1.2"
                                              rx="0.5" ry="0.5"/>

                                        <!-- 左側コネクタ (オス) - ケーブルの左端 (x=20) に接続, Y中心(y=20)に配置 -->
                                        <use href="#mc4-male-connector" x="20" y="20"/>

                                        <!-- 右側コネクタ (メス) - ケーブルの右端 (x=139) に接続, Y中心(y=20)に配置, 左右反転 -->
                                        <use href="#mc4-female-connector" x="139" y="20" transform="scale(-1, 1)"/>
                                      </g>
                                    </svg>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ③昇圧ユニット -->
                        <div id="boosterUnitContainer" class="system-diagram" style="margin-top: 30px; display: none;">
                            <h3 style="color: #005BAB; font-size: 1.1rem; margin-bottom: 1rem;">昇圧ユニット</h3>
                            <div class="diagram-container" style="text-align: center;">
                                <div class="component">
                                    <svg width="320" height="240" viewBox="0 0 320 240" xmlns="http://www.w3.org/2000/svg">
                                      <defs>
                                        <!-- 本体用の微妙なグラデーション -->
                                        <linearGradient id="unitBodyGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                          <stop offset="0%" style="stop-color:#E5E5E5; stop-opacity:1" />
                                          <stop offset="100%" style="stop-color:#D0D0D0; stop-opacity:1" />
                                        </linearGradient>
                                        <!-- LEDのハイライト用 -->
                                        <radialGradient id="ledHighlight" cx="0.3" cy="0.3" r="0.7">
                                          <stop offset="0%" style="stop-color:white; stop-opacity:0.8;" />
                                          <stop offset="100%" style="stop-color:transparent; stop-opacity:0.1;" />
                                        </radialGradient>
                                        <!-- 昇圧回路のグラデーション -->
                                        <linearGradient id="circuitGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                          <stop offset="0%" style="stop-color:#FF961C; stop-opacity:1" />
                                          <stop offset="100%" style="stop-color:#FF5722; stop-opacity:1" />
                                        </linearGradient>
                                      </defs>

                                      <!-- 本体ケーシング -->
                                      <rect x="110" y="5" width="100" height="170" rx="3" ry="3" fill="url(#unitBodyGradient)" stroke="#A0A0A0" stroke-width="1"/>

                                      <!-- ロゴ・型番エリア -->
                                      <rect x="115" y="15" width="90" height="35" fill="#F0F0F0" rx="2" ry="2" stroke="#C0C0C0" stroke-width="0.5"/>
                                      <text x="120" y="30" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#333">OMRON</text>
                                      <text x="120" y="43" font-family="Arial, sans-serif" font-size="7" fill="#555">MODEL SU-1000</text>

                                      <!-- LEDインジケーターエリア -->
                                      <rect x="115" y="55" width="90" height="60" fill="#E8E8E8" rx="2" ry="2" stroke="#C8C8C8" stroke-width="0.5"/>

                                      <!-- POWER LED -->
                                      <circle cx="130" cy="70" r="4" fill="#4CAF50"/> <!-- 緑 -->
                                      <circle cx="130" cy="70" r="4" fill="url(#ledHighlight)"/>
                                      <text x="140" y="73" font-family="Arial, sans-serif" font-size="7" fill="#333">POWER</text>

                                      <!-- ALARM LED -->
                                      <circle cx="130" cy="85" r="4" fill="#F44336"/> <!-- 赤 -->
                                      <circle cx="130" cy="85" r="4" fill="url(#ledHighlight)"/>
                                      <text x="140" y="88" font-family="Arial, sans-serif" font-size="7" fill="#333">ALARM</text>

                                      <!-- OUTPUT LED -->
                                      <circle cx="130" cy="100" r="4" fill="#FF9800"/> <!-- オレンジ -->
                                      <circle cx="130" cy="100" r="4" fill="url(#ledHighlight)"/>
                                      <text x="140" y="103" font-family="Arial, sans-serif" font-size="7" fill="#333">OUTPUT</text>

                                      <!-- 端子台カバー (下部) -->
                                      <rect x="115" y="120" width="90" height="45" fill="#4A4A4A" rx="2" ry="2" stroke="#333333" stroke-width="1"/>
                                      <!-- 端子台カバーのネジ (装飾) -->
                                      <circle cx="125" cy="128" r="1.5" fill="#777"/>
                                      <circle cx="195" cy="128" r="1.5" fill="#777"/>
                                      <circle cx="125" cy="157" r="1.5" fill="#777"/>
                                      <circle cx="195" cy="157" r="1.5" fill="#777"/>
                                      <!-- 端子番号のラベル風 (簡略) -->
                                      <rect x="122" y="135" width="76" height="18" fill="#5A5A5A" rx="1" ry="1"/>
                                      <text x="125" y="147" font-family="monospace" font-size="7" fill="#C0C0C0">L1 L2 PE +V -V SG</text>

                                      <!-- 元画像の底面に見える黒い部分 -->
                                      <rect x="110" y="175" width="100" height="8" fill="#303030" stroke="#1A1A1A" stroke-width="0.5"/>
                                      
                                      <!-- 昇圧回路図を追加 -->
                                      <g id="boost-circuit" transform="translate(10, 190)">
                                        <text x="150" y="-5" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#333">DC-DC昇圧回路</text>
                                        
                                        <!-- 入力端 -->
                                        <text x="20" y="25" font-family="Arial, sans-serif" font-size="8" fill="#333">入力</text>
                                        <text x="20" y="35" font-family="Arial, sans-serif" font-size="8" fill="#333" id="circuit-input-voltage">150V</text>
                                        
                                        <!-- DC入力ライン -->
                                        <line x1="40" y1="30" x2="80" y2="30" class="boost-circuit circuit-path" />
                                        
                                        <!-- インダクタ -->
                                        <path d="M80,30 C85,30 90,15 95,30 C100,45 105,15 110,30" class="boost-circuit circuit-component" />
                                        <text x="95" y="10" class="circuit-label">インダクタ</text>
                                        
                                        <!-- 中間ライン -->
                                        <line x1="110" y1="30" x2="140" y2="30" class="boost-circuit circuit-path" />
                                        
                                        <!-- ダイオード -->
                                        <path d="M140,30 L160,30 M150,20 L150,40 M155,30 L165,20 L165,40 Z" class="boost-circuit circuit-component" />
                                        <text x="150" y="10" class="circuit-label">ダイオード</text>
                                        
                                        <!-- スイッチング素子（MOSFET表現） -->
                                        <rect x="140" y="40" width="20" height="15" rx="2" class="boost-circuit circuit-component" />
                                        <text x="150" y="65" class="circuit-label">MOSFET</text>
                                        <line x1="150" y1="40" x2="150" y2="30" class="boost-circuit circuit-component" />
                                        <line x1="150" y1="55" x2="150" y2="60" class="boost-circuit circuit-path" />
                                        <line x1="140" y1="60" x2="160" y2="60" class="boost-circuit circuit-path" />
                                        
                                        <!-- GND -->
                                        <path d="M145,60 L155,60 M147,62 L153,62 M149,64 L151,64" class="boost-circuit circuit-component" />
                                        
                                        <!-- コンデンサ -->
                                        <path d="M165,30 L180,30 M180,20 L180,40" class="boost-circuit circuit-path" />
                                        <path d="M180,25 L180,35 M190,25 L190,35" class="boost-circuit circuit-component" />
                                        <line x1="190" y1="30" x2="200" y2="30" class="boost-circuit circuit-path" />
                                        <text x="185" y="10" class="circuit-label">コンデンサ</text>
                                        
                                        <!-- 制御回路 -->
                                        <rect x="120" y="70" width="60" height="20" rx="2" class="boost-circuit circuit-component" />
                                        <text x="150" y="84" class="circuit-label">制御回路</text>
                                        <line x1="150" y1="70" x2="150" y2="60" class="boost-circuit circuit-path" stroke-dasharray="2,1" />
                                        
                                        <!-- 出力端 -->
                                        <text x="220" y="25" font-family="Arial, sans-serif" font-size="8" fill="#333">出力</text>
                                        <text x="220" y="35" font-family="Arial, sans-serif" font-size="8" fill="#333" id="circuit-output-voltage">300V</text>
                                        <line x1="200" y1="30" x2="220" y2="30" class="boost-circuit circuit-path" />
                                        
                                        <!-- 電流フロー表現 -->
                                        <circle cx="60" cy="30" r="3" class="current-flow" />
                                        <circle cx="120" cy="30" r="3" class="current-flow" />
                                        <circle cx="170" cy="30" r="3" class="current-flow" />
                                      </g>
                                    </svg>
                                    <div style="margin-top: 5px;"><span id="boosterInputVoltage">150V</span> → <span id="boosterOutputVoltage">300V</span></div>
                                    <div style="margin-top: 5px;">変換効率: <span id="boosterEfficiencyValue">97.5%</span></div>
                                </div>
                            </div>
                            
                            <!-- 各ストリングの昇圧回路表示 -->
                            <div id="boosterCircuitContainer" class="system-diagram" style="margin-top: 20px;">
                                <!-- ストリングごとの昇圧回路はJSで動的に生成 -->
                            </div>
                        </div>
                        
                        <!-- ④接続箱 -->
                        <div id="junctionBoxContainer" class="system-diagram" style="margin-top: 30px;">
                            <h3 style="color: #005BAB; font-size: 1.1rem; margin-bottom: 1rem;">接続箱</h3>
                            <div class="diagram-container" style="text-align: center;">
                                <div class="component">
                                    <svg width="200" height="230" viewBox="0 0 200 230" xmlns="http://www.w3.org/2000/svg">
                                      <defs>
                                        <!-- 本体・蓋用のグラデーション -->
                                        <linearGradient id="connBoxFrontGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                          <stop offset="0%" style="stop-color:#E8E8E8;" />
                                          <stop offset="100%" style="stop-color:#C8C8C8;" />
                                        </linearGradient>
                                        <linearGradient id="connBoxSideGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                          <stop offset="0%" style="stop-color:#D0D0D0;" />
                                          <stop offset="100%" style="stop-color:#B0B0B0;" />
                                        </linearGradient>
                                        <!-- 金属部品（蝶番、ラッチ）用グラデーション -->
                                        <linearGradient id="connMetalGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                          <stop offset="0%" style="stop-color:#C0C0C0;" />
                                          <stop offset="100%" style="stop-color:#A0A0A0;" />
                                        </linearGradient>
                                        <!-- ケーブルグランド用グラデーション -->
                                        <linearGradient id="connGlandCoreGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                          <stop offset="0%" style="stop-color:#888888;" />
                                          <stop offset="100%" style="stop-color:#686868;" />
                                        </linearGradient>
                                      </defs>

                                      <!-- 箱本体 (蓋の背景となり、縁が見えることで奥行きを表現) -->
                                      <rect x="5" y="5" width="190" height="200" rx="6" ry="6" fill="url(#connBoxSideGradient)" stroke="#7A7A7A" stroke-width="1"/>

                                      <!-- 蓋 -->
                                      <rect x="12" y="12" width="176" height="186" rx="3" ry="3" fill="url(#connBoxFrontGradient)" stroke="#999999" stroke-width="1.2"/>

                                      <!-- 蝶番 (左側) -->
                                      <g class="hinge">
                                        <!-- 蓋側プレート -->
                                        <rect x="12" y="45" width="12" height="25" rx="1.5" ry="1.5" fill="url(#connMetalGradient)" stroke="#707070" stroke-width="0.5"/>
                                        <rect x="12" y="140" width="12" height="25" rx="1.5" ry="1.5" fill="url(#connMetalGradient)" stroke="#707070" stroke-width="0.5"/>
                                        <!-- 本体側プレート (少し隠れる) -->
                                        <rect x="7" y="45" width="8" height="25" rx="1.5" ry="1.5" fill="url(#connMetalGradient)" stroke="#707070" stroke-width="0.5"/>
                                        <rect x="7" y="140" width="8" height="25" rx="1.5" ry="1.5" fill="url(#connMetalGradient)" stroke="#707070" stroke-width="0.5"/>
                                        <!-- ピン部分 -->
                                        <rect x="10.5" y="43" width="5" height="29" rx="1" ry="1" fill="#808080" stroke="#606060" stroke-width="0.5"/>
                                        <rect x="10.5" y="138" width="5" height="29" rx="1" ry="1" fill="#808080" stroke="#606060" stroke-width="0.5"/>
                                      </g>

                                      <!-- ラッチ (右側、簡易的なパッチン錠風) -->
                                      <g class="latch">
                                        <!-- 本体側フック受け -->
                                        <rect x="182" y="97.5" width="7" height="25" rx="2" ry="2" fill="url(#connMetalGradient)" stroke="#707070" stroke-width="0.5"/>
                                        <rect x="183" y="100" width="3" height="20" fill="#909090"/>
                                        <!-- 蓋側レバー -->
                                        <path d="M170 100 L182 103 L182 117 L170 120 Q168 110 170 100 Z"
                                              fill="#D8D8D8" stroke="#888" stroke-width="0.7"/>
                                        <ellipse cx="176" cy="110" rx="6" ry="3.5" fill="#B8B8B8" stroke="#707070" stroke-width="0.5"/>
                                      </g>

                                      <!-- 銘板エリア -->
                                      <rect x="70" y="22" width="60" height="22" fill="#F8F8F8" rx="1.5" ry="1.5" stroke="#B0B0B0" stroke-width="0.5"/>
                                      <text x="74" y="31" font-family="Arial, sans-serif" font-size="7" font-weight="bold" fill="#444">接続箱</text>
                                      <text x="74" y="39" font-family="Arial, sans-serif" font-size="5" fill="#666">TYPE: JB-21A</text>

                                      <!-- ケーブルグランド (下部) - 箱の底面のY座標は約205 -->
                                      <g class="cable-glands">
                                        <!-- グランド1 -->
                                        <g transform="translate(30, 203)">
                                          <ellipse cx="10" cy="0.5" rx="11" ry="3.5" fill="#A0A0A0" stroke="#505050" stroke-width="0.5"/> <!-- フランジ/箱との接合部 -->
                                          <rect x="4" y="0" width="12" height="16" rx="1" ry="1" fill="url(#connGlandCoreGradient)" stroke="#484848" stroke-width="0.7"/> <!-- 本体 -->
                                          <ellipse cx="10" cy="16" rx="8" ry="3" fill="#B0B0B0" stroke="#505050" stroke-width="0.5"/> <!-- ナット先端 -->
                                        </g>
                                        <!-- グランド2 -->
                                        <g transform="translate(70, 203)">
                                          <ellipse cx="10" cy="0.5" rx="11" ry="3.5" fill="#A0A0A0" stroke="#505050" stroke-width="0.5"/>
                                          <rect x="4" y="0" width="12" height="16" rx="1" ry="1" fill="url(#connGlandCoreGradient)" stroke="#484848" stroke-width="0.7"/>
                                          <ellipse cx="10" cy="16" rx="8" ry="3" fill="#B0B0B0" stroke="#505050" stroke-width="0.5"/>
                                        </g>
                                        <!-- グランド3 -->
                                        <g transform="translate(110, 203)">
                                          <ellipse cx="10" cy="0.5" rx="11" ry="3.5" fill="#A0A0A0" stroke="#505050" stroke-width="0.5"/>
                                          <rect x="4" y="0" width="12" height="16" rx="1" ry="1" fill="url(#connGlandCoreGradient)" stroke="#484848" stroke-width="0.7"/>
                                          <ellipse cx="10" cy="16" rx="8" ry="3" fill="#B0B0B0" stroke="#505050" stroke-width="0.5"/>
                                        </g>
                                        <!-- グランド4 -->
                                        <g transform="translate(150, 203)">
                                          <ellipse cx="10" cy="0.5" rx="11" ry="3.5" fill="#A0A0A0" stroke="#505050" stroke-width="0.5"/>
                                          <rect x="4" y="0" width="12" height="16" rx="1" ry="1" fill="url(#connGlandCoreGradient)" stroke="#484848" stroke-width="0.7"/>
                                          <ellipse cx="10" cy="16" rx="8" ry="3" fill="#B0B0B0" stroke="#505050" stroke-width="0.5"/>
                                        </g>
                                      </g>
                                    </svg>
                                    <div style="margin-top: 5px;">ストリング数: <span id="junctionBoxStringCount">3</span></div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ⑤パワコン（複数パワコン対応版） -->
                        <div id="powerConditionerContainer">
                            <!-- パワコンはJSで動的に生成 -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 用語と説明タブコンテンツ -->
        <div class="tab-content" id="glossary-content">
            <div class="glossary-container">
                <div class="glossary-search">
                    <input type="text" id="termSearch" placeholder="用語を検索...">
                </div>
                
                <div class="glossary-categories">
                    <!-- カテゴリーアコーディオン -->
                    <div class="glossary-category">
                        <div class="category-header">
                            <h2>基本用語</h2>
                            <span class="toggle-icon">▼</span>
                        </div>
                        <div class="category-content">
                            <!-- 基本用語の説明 -->
                            <div class="term-item">
                                <h3>太陽電池モジュール（パネル）</h3>
                                <p>太陽光を電気エネルギーに変換する装置です。複数の太陽電池セル（光電変換素子）が直列・並列に接続され、耐候性のあるガラスやフレームで保護されています。一般的には「パネル」と呼ばれています。</p>
                                <p>現在主流のものは、単結晶シリコン、多結晶シリコン、薄膜系などがあります。</p>
                            </div>
                            
                            <div class="term-item">
                                <h3>パネル定格出力</h3>
                                <p>標準試験条件（STC：放射照度1000W/m²、セル温度25℃、エアマス1.5の光スペクトル）で測定された、太陽電池モジュールが発電できる最大電力です。単位はワット（W）で表します。</p>
                                <p>現在の一般的な住宅用パネルでは330W～450W程度、産業用では400W～550W程度が主流です。</p>
                            </div>
                            
                            <div class="term-item">
                                <h3>パネル変換効率</h3>
                                <p>太陽電池モジュールに入射する太陽光エネルギーに対する、発電される電気エネルギーの割合です。パーセント（%）で表示されます。</p>
                                <p>現在の主流シリコン系モジュールでは約15-22%程度の効率が一般的ですが、高効率パネルでは24%を超えるものもあります。変換効率が高いほど、同じ面積でより多くの電力を得られます。</p>
                            </div>
                            
                            <div class="term-item">
                                <h3>システム容量</h3>
                                <p>太陽光発電システム全体の総出力容量で、パネルの定格出力とパネル枚数の積で計算されます。単位はキロワット（kW）で表します。</p>
                                <p>例：330Wのパネルを12枚設置した場合、システム容量は330W×12枚÷1000=3.96kWとなります。</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="glossary-category">
                        <div class="category-header">
                            <h2>システム構成</h2>
                            <span class="toggle-icon">▼</span>
                        </div>
                        <div class="category-content">
                            <!-- システム構成の説明 -->
                            <div class="term-item">
                                <h3>ストリング</h3>
                                <p>複数の太陽電池モジュールを直列に接続したものです。直列接続することで電圧を高めます。</p>
                                <p>一般的なパワーコンディショナーへの入力電圧範囲（例：DC250V-540V）に合わせて、適切な数のパネルを直列接続します。一般的には5-10枚程度のパネルで1ストリングを構成します。</p>
                                <p>発電システムでは、複数のストリングを並列接続することで必要な電流を得ます。</p>
                            </div>
                            
                            <div class="term-item">
                                <h3>接続箱</h3>
                                <p>複数のストリングを並列に接続し、パワーコンディショナーへの入力を一本化する装置です。保護装置（ヒューズや開閉器）も内蔵されています。</p>
                                <p>ストリング毎の電流モニタリングや過電流保護、サージ保護などの機能を持つ接続箱もあります。マルチストリング型パワコンでは不要な場合もあります。</p>
                            </div>
                            
                            <div class="term-item">
                                <h3>パワーコンディショナー（パワコン）</h3>
                                <p>太陽電池モジュールで発電されたDC（直流）電力をAC（交流）電力に変換する装置です。系統連系型の太陽光発電システムでは、商用電力系統と適合するように電力を調整します。</p>
                                <p>主な機能：</p>
                                <ul>
                                    <li>DC-AC変換（インバーター機能）</li>
                                    <li>最大電力点追従制御（MPPT制御）</li>
                                    <li>系統連系保護機能（単独運転検出、電圧上昇抑制など）</li>
                                    <li>直流地絡検出</li>
                                </ul>
                            </div>
                            
                            <div class="term-item">
                                <h3>パワコンタイプ</h3>
                                <p><strong>標準型(ストリング型)：</strong> 最も一般的なタイプで、1つのMPPT回路で全ストリングを制御します。</p>
                                <p><strong>マルチストリング型：</strong> 複数のMPPT回路を搭載し、各ストリングを個別に最適制御します。方位や傾斜が異なるパネル配置や部分的な影がある場合に有効です。</p>
                                <p><strong>ハイブリッド型：</strong> 太陽光発電と蓄電池を統合管理できる型で、自家消費率の向上や非常時のバックアップ電源として機能します。</p>
                                <p><strong>マイクロインバーター型：</strong> 各パネルに1つのインバーターを設置し、パネル単位で最適化します。部分的な影響を受けた場合でも他のパネルへの影響を最小化できます。</p>
                            </div>
                            
                            <div class="term-item">
                                <h3>MPPT回路</h3>
                                <p>Maximum Power Point Tracking（最大電力点追従）の略。太陽電池モジュールが常に最大出力を発揮できるよう、負荷を調整する機能です。</p>
                                <p>日射条件や温度変化によって太陽電池の出力特性（IV曲線）は刻々と変化します。MPPT回路は、その変化に応じて常に最大出力が得られる動作点を自動で追従することで、発電量を最大化します。</p>
                                <p>マルチストリング型パワコンでは、複数のMPPT回路があるため、ストリングごとに異なる条件（方位、傾斜、影の影響など）でも最適な発電ができます。</p>
                            </div>
                            
                            <div class="term-item">
                                <h3>昇圧ユニット（DC-DCコンバータ）</h3>
                                <p>太陽電池モジュールの出力電圧を昇圧して、パワーコンディショナーの動作に適した電圧にする装置です。</p>
                                <p>以下のような場合に使用されます：</p>
                                <ul>
                                    <li>パネル設置枚数が少なく電圧が低い場合</li>
                                    <li>部分影の影響でストリング電圧が変動する場合</li>
                                    <li>パワコンの最低動作電圧を確保するため</li>
                                </ul>
                                <p>昇圧ユニットを使用すると約2-3%の変換損失が発生しますが、低電圧によるパワコンの動作不安定や効率低下を防ぐことができます。</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="glossary-category">
                        <div class="category-header">
                            <h2>設置・環境要因</h2>
                            <span class="toggle-icon">▼</span>
                        </div>
                        <div class="category-content">
                            <!-- 設置・環境要因の説明 -->
                            <div class="term-item">
                                <h3>傾斜角</h3>
                                <p>太陽電池モジュールが水平面となす角度です。最適な発電量を得るために調整されます。</p>
                                <p>日本では、年間発電量を最大化する場合、緯度とほぼ同じ角度（北海道で約40°、東京で約35°、沖縄で約25°）が理論上の最適値です。ただし、設置コストや積雪対策なども考慮し、実際には20〜30°程度に設定されることが多いです。</p>
                                <p>夏季の発電量を重視する場合は浅め（10-20°）に、冬季の発電量を重視する場合は深め（30-40°）に設定します。</p>
                            </div>
                            
                            <div class="term-item">
                                <h3>方位角</h3>
                                <p>太陽電池モジュールが向いている方角を表す角度です。真南を0度として、東がマイナス、西がプラスで表現します。</p>
                                <p>一般的に、北半球では真南向き（0度）が年間発電量を最大化します。ただし、完全な真南でなくても、東西に30度程度ずれていても年間発電量への影響は5%程度に留まります。</p>
                                <p>電力需要パターンによっては、西向き（午後の発電量増加）や東向き（午前の発電量増加）が有利な場合もあります。</p>
                            </div>
                            
                            <div class="term-item">
                                <h3>天候条件</h3>
                                <p>日射量に影響する気象状態です。本シミュレーターでは、晴れ、薄曇り、曇り、雨の4段階で設定できます。</p>
                                <p>天候による日射強度の目安：</p>
                                <ul>
                                    <li>晴れ：800-1000W/m²</li>
                                    <li>薄曇り：500-700W/m²</li>
                                    <li>曇り：200-400W/m²</li>
                                    <li>雨：100-200W/m²</li>
                                </ul>
                                <p>年間の天候パターンは地域によって大きく異なり、日本では平均して年間約1,500時間の日照があります。</p>
                            </div>
                            
                            <div class="term-item">
                                <h3>周囲温度</h3>
                                <p>太陽電池モジュールの周辺の気温です。高温になるほどモジュールの発電効率が低下します。</p>
                                <p>一般的なシリコン系モジュールでは、温度係数は約-0.4%/℃で、標準試験条件（25℃）より温度が1℃上昇するごとに、出力が約0.4%低下します。</p>
                                <p>実際のパネル温度は周囲温度より夏場で20-30℃、冬場で5-15℃高くなることがあります。例えば、気温が35℃の夏場では、パネル温度が55-65℃に達し、定格出力から12-16%程度低下することになります。</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="glossary-category">
                        <div class="category-header">
                            <h2>効率と損失</h2>
                            <span class="toggle-icon">▼</span>
                        </div>
                        <div class="category-content">
                            <!-- 効率と損失の説明 -->
                            <div class="term-item">
                                <h3>システム効率</h3>
                                <p>太陽光発電システム全体の変換効率で、太陽光エネルギーから実際に得られる電力の割合を示します。以下の要素が複合的に作用します：</p>
                                <ul>
                                    <li>パネル変換効率（15-22%）</li>
                                    <li>パワコン変換効率（92-97%）</li>
                                    <li>配線損失（1-3%）</li>
                                    <li>温度による損失（5-15%）</li>
                                    <li>その他の損失（3-8%）</li>
                                </ul>
                                <p>総合的なシステム効率は、理想的な条件下でも70-85%程度となります。つまり、パネルの定格容量に対して、実際の年間発電量は理論値の70-85%になります。</p>
                            </div>
                            
                            <div class="term-item">
                                <h3>クリッピングロス</h3>
                                <p>パワーコンディショナーの定格容量を超える発電があった場合に発生する損失です。パワコンは入力電力が定格を超えた場合、電力を制限（クリッピング）します。</p>
                                <p>例えば、4kWのパワコンに対して4.2kWのパネルを接続すると、晴天時には0.2kW分の電力が制限されます。しかし、曇りや朝夕の日射量の少ない時間帯では、パネル出力が4kWを下回るため、クリッピングは発生しません。</p>
                                <p>年間ベースでは、パネル容量をパワコン容量の110-120%程度にすると、クリッピングロスは年間発電量の1-3%程度に抑えられ、むしろシステム全体の経済性が向上することがあります。</p>
                            </div>
                            
                            <div class="term-item">
                                <h3>温度ロス</h3>
                                <p>高温によるパネル効率の低下です。太陽電池モジュールは温度が上昇すると変換効率が低下します。</p>
                                <p>温度係数（一般的に約-0.4%/℃）に基づいて計算され、夏季の高温時には10%以上の損失が生じることもあります。</p>
                                <p>パネル裏面の通気を確保することで、温度上昇を抑制し、損失を軽減することができます。</p>
                            </div>
                            
                            <div class="term-item">
                                <h3>配線ロス</h3>
                                <p>配線の抵抗による電力損失です。特に直流側の低電圧・高電流の条件で顕著になります。</p>
                                <p>配線径の適切な選定やケーブル長の最小化により、1-3%程度に抑えることが可能です。</p>
                                <p>電流（A）の2乗に比例して損失が増加するため、大規模システムでは特に重要な検討要素となります。</p>
                            </div>
                            
                            <div class="term-item">
                                <h3>ミスマッチロス</h3>
                                <p>直列接続されたモジュール間の出力差による損失です。直列接続では、最も出力の低いモジュールに合わせて電流が制限されます。</p>
                                <p>製造時の出力ばらつき（1-3%）や、部分的な影、汚れ、劣化差などによって生じます。</p>
                                <p>マルチストリング型パワコンやマイクロインバーター型システムでは、この影響を軽減できます。</p>
                            </div>
                            
                            <div class="term-item">
                                <h3>汚れや影による損失</h3>
                                <p>モジュール表面の汚れや部分的な影による発電効率の低下です。</p>
                                <p>汚れによる損失は地域環境によって異なり、都市部や工業地域、花粉の多い地域などでは5%以上になることもあります。定期的な清掃により軽減可能です。</p>
                                <p>影による損失は、ストリング全体に影響を及ぼす場合があります。設計時に周辺の建物や樹木などの影響を考慮し、最小化することが重要です。</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="js/solar-power.js"></script>
</body>
</html>